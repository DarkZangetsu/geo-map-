(()=>{var e={};e.id=997,e.ids=[997],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11703:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var o=r(60687);function s({isOpen:e,onClose:t,onConfirm:r,title:s,message:n,confirmText:a="Confirmer",cancelText:l="Annuler",confirmButtonClass:i="bg-green-600 hover:bg-green-700",cancelButtonClass:d="bg-gray-300 hover:bg-gray-400",confirmLoading:c=!1,confirmDisabled:u=!1}){return e?(0,o.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,o.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,o.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:s}),(0,o.jsx)("p",{className:"text-gray-600 mb-6",children:n}),(0,o.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,o.jsx)("button",{onClick:t,className:`px-4 py-2 rounded font-semibold text-gray-700 ${d}`,disabled:c,children:l}),(0,o.jsxs)("button",{onClick:r,className:`px-4 py-2 rounded font-semibold text-white flex items-center justify-center gap-2 ${i}`,disabled:u,children:[c&&(0,o.jsx)("span",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2 inline-block"}),a]})]})]})}):null}r(43210)},11860:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});let o=(0,r(62688).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},22710:(e,t,r)=>{"use strict";r.d(t,{n:()=>u});var o=r(4363),s=r(42146),n=r(20236),a=r(29689),l=r(95803),i=r(5459),d=r(58151),c=r(62851).Sw?s.useLayoutEffect:s.useEffect;function u(e,t){var r=(0,d.m)(null==t?void 0:t.client);(0,l.D$)(e,l.KG.Mutation);var u=s.useState({called:!1,loading:!1,client:r}),m=u[0],p=u[1],x=s.useRef({result:m,mutationId:0,isMounted:!0,client:r,mutation:e,options:t});c(function(){Object.assign(x.current,{client:r,options:t,mutation:e})});var f=s.useCallback(function(e){void 0===e&&(e={});var t=x.current,r=t.options,s=t.mutation,l=(0,o.Cl)((0,o.Cl)({},r),{mutation:s}),d=e.client||x.current.client;x.current.result.loading||l.ignoreResults||!x.current.isMounted||p(x.current.result={loading:!0,error:void 0,data:void 0,called:!0,client:d});var c=++x.current.mutationId,u=(0,n.l)(l,e);return d.mutate(u).then(function(t){var r,o,s=t.data,n=t.errors,l=n&&n.length>0?new i.K4({graphQLErrors:n}):void 0,m=e.onError||(null==(r=x.current.options)?void 0:r.onError);if(l&&m&&m(l,u),c===x.current.mutationId&&!u.ignoreResults){var f={called:!0,loading:!1,data:s,error:l,client:d};x.current.isMounted&&!(0,a.L)(x.current.result,f)&&p(x.current.result=f)}var g=e.onCompleted||(null==(o=x.current.options)?void 0:o.onCompleted);return l||null==g||g(t.data,u),t},function(t){if(c===x.current.mutationId&&x.current.isMounted){var r,o={loading:!1,error:t,data:void 0,called:!0,client:d};(0,a.L)(x.current.result,o)||p(x.current.result=o)}var s=e.onError||(null==(r=x.current.options)?void 0:r.onError);if(s)return s(t,u),{data:void 0,errors:t};throw t})},[]),g=s.useCallback(function(){if(x.current.isMounted){var e={called:!1,loading:!1,client:x.current.client};Object.assign(x.current,{mutationId:0,result:e}),p(e)}},[]);return s.useEffect(function(){var e=x.current;return e.isMounted=!0,function(){e.isMounted=!1}},[]),[f,(0,o.Cl)({reset:g},m)]}},25606:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d});var o=r(65239),s=r(48088),n=r(88170),a=r.n(n),l=r(30893),i={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>l[e]);r.d(t,i);let d={children:["",{children:["profil",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,64409)),"C:\\Users\\User\\Videos\\Nouveau dossier\\geomap\\geo-map-\\frontend\\src\\app\\profil\\page.js"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,75535)),"C:\\Users\\User\\Videos\\Nouveau dossier\\geomap\\geo-map-\\frontend\\src\\app\\layout.js"],"not-found":[()=>Promise.resolve().then(r.bind(r,28069)),"C:\\Users\\User\\Videos\\Nouveau dossier\\geomap\\geo-map-\\frontend\\src\\app\\not-found.js"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["C:\\Users\\User\\Videos\\Nouveau dossier\\geomap\\geo-map-\\frontend\\src\\app\\profil\\page.js"],u={require:r,loadChunk:()=>Promise.resolve()},m=new o.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/profil/page",pathname:"/profil",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},35533:(e,t,r)=>{"use strict";r.d(t,{z:()=>n}),r(43210);var o=r(16189),s=r(89162);function n(e=!0){let{user:t,isAuthenticated:r,isLoading:a}=(0,s.h)();return(0,o.useRouter)(),{user:t,isAuthenticated:r,isLoading:a,isAuthorized:!e||r}}r(65222)},48595:(e,t,r)=>{Promise.resolve().then(r.bind(r,64409))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64409:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});let o=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\User\\\\Videos\\\\Nouveau dossier\\\\geomap\\\\geo-map-\\\\frontend\\\\src\\\\app\\\\profil\\\\page.js\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\User\\Videos\\Nouveau dossier\\geomap\\geo-map-\\frontend\\src\\app\\profil\\page.js","default")},85547:(e,t,r)=>{Promise.resolve().then(r.bind(r,95959))},95959:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>eh});var o=r(60687),s=r(43210),n=r(8829),a=r(22710),l=r(48443),i=r(52581),d=r(35533),c=r(11703),u=r(89162),m=r(65222),p=r(70569),x=r(98599),f=r(33654),g=r(96963),h=r(65551),b=r(31355),v=r(32547),j=r(25028),w=r(46059),y=r(14163),N=r(1359),k=r(11490),C=r(63376),P=r(8730),R="Dialog",[E,I]=(0,f.A)(R),[L,M]=E(R),A=e=>{let{__scopeDialog:t,children:r,open:n,defaultOpen:a,onOpenChange:l,modal:i=!0}=e,d=s.useRef(null),c=s.useRef(null),[u,m]=(0,h.i)({prop:n,defaultProp:a??!1,onChange:l,caller:R});return(0,o.jsx)(L,{scope:t,triggerRef:d,contentRef:c,contentId:(0,g.B)(),titleId:(0,g.B)(),descriptionId:(0,g.B)(),open:u,onOpenChange:m,onOpenToggle:s.useCallback(()=>m(e=>!e),[m]),modal:i,children:r})};A.displayName=R;var D="DialogTrigger";s.forwardRef((e,t)=>{let{__scopeDialog:r,...s}=e,n=M(D,r),a=(0,x.s)(t,n.triggerRef);return(0,o.jsx)(y.sG.button,{type:"button","aria-haspopup":"dialog","aria-expanded":n.open,"aria-controls":n.contentId,"data-state":Y(n.open),...s,ref:a,onClick:(0,p.m)(e.onClick,n.onOpenToggle)})}).displayName=D;var _="DialogPortal",[z,O]=E(_,{forceMount:void 0}),U=e=>{let{__scopeDialog:t,forceMount:r,children:n,container:a}=e,l=M(_,t);return(0,o.jsx)(z,{scope:t,forceMount:r,children:s.Children.map(n,e=>(0,o.jsx)(w.C,{present:r||l.open,children:(0,o.jsx)(j.Z,{asChild:!0,container:a,children:e})}))})};U.displayName=_;var S="DialogOverlay",F=s.forwardRef((e,t)=>{let r=O(S,e.__scopeDialog),{forceMount:s=r.forceMount,...n}=e,a=M(S,e.__scopeDialog);return a.modal?(0,o.jsx)(w.C,{present:s||a.open,children:(0,o.jsx)(B,{...n,ref:t})}):null});F.displayName=S;var q=(0,P.TL)("DialogOverlay.RemoveScroll"),B=s.forwardRef((e,t)=>{let{__scopeDialog:r,...s}=e,n=M(S,r);return(0,o.jsx)(k.A,{as:q,allowPinchZoom:!0,shards:[n.contentRef],children:(0,o.jsx)(y.sG.div,{"data-state":Y(n.open),...s,ref:t,style:{pointerEvents:"auto",...s.style}})})}),G="DialogContent",W=s.forwardRef((e,t)=>{let r=O(G,e.__scopeDialog),{forceMount:s=r.forceMount,...n}=e,a=M(G,e.__scopeDialog);return(0,o.jsx)(w.C,{present:s||a.open,children:a.modal?(0,o.jsx)(V,{...n,ref:t}):(0,o.jsx)($,{...n,ref:t})})});W.displayName=G;var V=s.forwardRef((e,t)=>{let r=M(G,e.__scopeDialog),n=s.useRef(null),a=(0,x.s)(t,r.contentRef,n);return s.useEffect(()=>{let e=n.current;if(e)return(0,C.Eq)(e)},[]),(0,o.jsx)(T,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:(0,p.m)(e.onCloseAutoFocus,e=>{e.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:(0,p.m)(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,r=0===t.button&&!0===t.ctrlKey;(2===t.button||r)&&e.preventDefault()}),onFocusOutside:(0,p.m)(e.onFocusOutside,e=>e.preventDefault())})}),$=s.forwardRef((e,t)=>{let r=M(G,e.__scopeDialog),n=s.useRef(!1),a=s.useRef(!1);return(0,o.jsx)(T,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(n.current||r.triggerRef.current?.focus(),t.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(n.current=!0,"pointerdown"===t.detail.originalEvent.type&&(a.current=!0));let o=t.target;r.triggerRef.current?.contains(o)&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&a.current&&t.preventDefault()}})}),T=s.forwardRef((e,t)=>{let{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:l,...i}=e,d=M(G,r),c=s.useRef(null),u=(0,x.s)(t,c);return(0,N.Oh)(),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(v.n,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:l,children:(0,o.jsx)(b.qW,{role:"dialog",id:d.contentId,"aria-describedby":d.descriptionId,"aria-labelledby":d.titleId,"data-state":Y(d.open),...i,ref:u,onDismiss:()=>d.onOpenChange(!1)})}),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(eo,{titleId:d.titleId}),(0,o.jsx)(es,{contentRef:c,descriptionId:d.descriptionId})]})]})}),H="DialogTitle",K=s.forwardRef((e,t)=>{let{__scopeDialog:r,...s}=e,n=M(H,r);return(0,o.jsx)(y.sG.h2,{id:n.titleId,...s,ref:t})});K.displayName=H;var Q="DialogDescription",Z=s.forwardRef((e,t)=>{let{__scopeDialog:r,...s}=e,n=M(Q,r);return(0,o.jsx)(y.sG.p,{id:n.descriptionId,...s,ref:t})});Z.displayName=Q;var J="DialogClose",X=s.forwardRef((e,t)=>{let{__scopeDialog:r,...s}=e,n=M(J,r);return(0,o.jsx)(y.sG.button,{type:"button",...s,ref:t,onClick:(0,p.m)(e.onClick,()=>n.onOpenChange(!1))})});function Y(e){return e?"open":"closed"}X.displayName=J;var ee="DialogTitleWarning",[et,er]=(0,f.q)(ee,{contentName:G,titleName:H,docsSlug:"dialog"}),eo=({titleId:e})=>{let t=er(ee),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return s.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},es=({contentRef:e,descriptionId:t})=>{let r=er("DialogDescriptionWarning"),o=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${r.contentName}}.`;return s.useEffect(()=>{let r=e.current?.getAttribute("aria-describedby");t&&r&&(document.getElementById(t)||console.warn(o))},[o,e,t]),null},en=r(11860);function ea({...e}){return(0,o.jsx)(A,{"data-slot":"dialog",...e})}function el({...e}){return(0,o.jsx)(U,{"data-slot":"dialog-portal",...e})}function ei({...e}){return(0,o.jsx)(X,{"data-slot":"dialog-close",...e})}function ed({className:e,...t}){return(0,o.jsx)(F,{"data-slot":"dialog-overlay",className:(0,m.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function ec({className:e,children:t,showCloseButton:r=!0,...s}){return(0,o.jsxs)(el,{"data-slot":"dialog-portal",children:[(0,o.jsx)(ed,{}),(0,o.jsxs)(W,{"data-slot":"dialog-content",className:(0,m.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...s,children:[t,r&&(0,o.jsxs)(X,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,o.jsx)(en.A,{}),(0,o.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function eu({className:e,...t}){return(0,o.jsx)("div",{"data-slot":"dialog-header",className:(0,m.cn)("flex flex-col gap-2 text-center sm:text-left",e),...t})}function em({className:e,...t}){return(0,o.jsx)("div",{"data-slot":"dialog-footer",className:(0,m.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function ep({className:e,...t}){return(0,o.jsx)(K,{"data-slot":"dialog-title",className:(0,m.cn)("text-lg leading-none font-semibold",e),...t})}function ex({className:e,...t}){return(0,o.jsx)(Z,{"data-slot":"dialog-description",className:(0,m.cn)("text-muted-foreground text-sm",e),...t})}var ef=r(76717);function eg({open:e,onOpenChange:t,onSubmit:r,loading:n}){let[a,l]=(0,s.useState)({old:"",new1:"",new2:""}),i=e=>{let{name:t,value:r}=e.target;l(e=>({...e,[t]:r}))};return(0,o.jsx)(ea,{open:e,onOpenChange:t,children:(0,o.jsx)(ec,{children:(0,o.jsxs)("form",{onSubmit:e=>{e.preventDefault(),r(a,()=>l({old:"",new1:"",new2:""}))},className:"flex flex-col gap-4",children:[(0,o.jsxs)(eu,{children:[(0,o.jsx)(ep,{children:"Changer mon mot de passe"}),(0,o.jsx)(ex,{children:"Veuillez saisir votre ancien et nouveau mot de passe."})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ancien mot de passe"}),(0,o.jsx)("input",{type:"password",name:"old",value:a.old,onChange:i,required:!0,minLength:6,className:"w-full px-3 py-2 border border-gray-300 rounded-md",disabled:n})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nouveau mot de passe"}),(0,o.jsx)("input",{type:"password",name:"new1",value:a.new1,onChange:i,required:!0,minLength:6,className:"w-full px-3 py-2 border border-gray-300 rounded-md",disabled:n})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirmer le nouveau mot de passe"}),(0,o.jsx)("input",{type:"password",name:"new2",value:a.new2,onChange:i,required:!0,minLength:6,className:"w-full px-3 py-2 border border-gray-300 rounded-md",disabled:n})]}),(0,o.jsxs)(em,{children:[(0,o.jsx)(ef.$,{type:"submit",disabled:n||!a.old||!a.new1||!a.new2,children:n?"Enregistrement...":"Enregistrer"}),(0,o.jsx)(ei,{asChild:!0,children:(0,o.jsx)(ef.$,{type:"button",variant:"outline",children:"Annuler"})})]})]})})})}function eh(){let{isLoading:e,isAuthorized:t}=(0,d.z)(!0),{isAuthenticated:r}=(0,u.h)(),{data:p,loading:x,refetch:f,error:g}=(0,n.IT)(l.QG,{skip:!r,onError:e=>{console.error("Erreur GET_ME:",e)}}),[h]=(0,a.n)(l.ZY),[b]=(0,a.n)(l.yU),[v]=(0,a.n)(l.Qx),[j]=(0,a.n)(l.lj),w=p?.me,[y,N]=(0,s.useState)({nomInstitution:"",nomProjets:[],newProjet:"",email:"",abreviation:"",logo:null}),[k,C]=(0,s.useState)(!1),[P,R]=(0,s.useState)(!1),[E,I]=(0,s.useState)(!1),[L,M]=(0,s.useState)(!1),[A,D]=(0,s.useState)(!1),[_,z]=(0,s.useState)(null);if(e||!t)return(0,o.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center",children:(0,o.jsxs)("div",{className:"text-center bg-white rounded-2xl shadow-xl p-8 backdrop-blur-sm border border-white/20",children:[(0,o.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),(0,o.jsx)("p",{className:"mt-4 text-slate-600 font-medium",children:e?"V\xe9rification de l'authentification...":"Redirection vers la page de connexion..."})]})});if(!r)return(0,o.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center",children:(0,o.jsx)("div",{className:"text-center bg-white rounded-2xl shadow-xl p-8",children:(0,o.jsx)("div",{className:"text-slate-500 text-lg",children:"Veuillez vous connecter pour acc\xe9der \xe0 votre profil."})})});if(x)return(0,o.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center",children:(0,o.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-500"})});if(g)return(0,o.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center",children:(0,o.jsx)("div",{className:"text-center bg-white rounded-2xl shadow-xl p-8",children:(0,o.jsxs)("div",{className:"text-red-500 mb-4 font-medium",children:["Erreur lors du chargement du profil: ",g.message]})})});if(!w)return(0,o.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center",children:(0,o.jsx)("div",{className:"text-center bg-white rounded-2xl shadow-xl p-8",children:(0,o.jsx)("div",{className:"text-slate-500 text-lg",children:"Aucune donn\xe9e utilisateur."})})});let O=e=>{e.preventDefault();let t=y.newProjet.trim();t&&!y.nomProjets.includes(t)&&N(e=>({...e,nomProjets:[...e.nomProjets,t],newProjet:""}))},U=e=>{N(t=>({...t,nomProjets:t.nomProjets.filter(t=>t!==e)}))},S=async e=>{if(e.preventDefault(),y.nomInstitution===w.nomInstitution&&y.nomProjets.join(", ")===(w.nomProjet||"")&&y.email===w.email&&y.abreviation===w.abreviation)return void i.oR.error("Aucune modification d\xe9tect\xe9e");z("save"),D(!0)},F=async()=>{R(!0);try{let e=!0,t="";if(y.abreviation!==w.abreviation){let{data:r}=await h({variables:{userId:w.id,abreviation:y.abreviation}});r.updateUserAbreviation.success||(e=!1,t=r.updateUserAbreviation.message)}if(e&&(y.nomInstitution!==w.nomInstitution||y.nomProjets.join(", ")!==(w.nomProjet||"")||y.email!==w.email)){let{data:r}=await v({variables:{nomInstitution:y.nomInstitution,nomProjet:y.nomProjets.join(", "),email:y.email}});r.updateUserProfile.success||(e=!1,t=r.updateUserProfile.message)}e?(i.oR.success("Profil mis \xe0 jour avec succ\xe8s"),C(!1),f()):i.oR.error(t||"Erreur lors de la mise \xe0 jour")}catch(e){console.error("Erreur lors de la mise \xe0 jour:",e),i.oR.error("Erreur lors de la mise \xe0 jour")}finally{R(!1),D(!1),z(null)}},q=async e=>{e.target.files?.[0]&&(z("logo"),D(!0))},B=async()=>{R(!0);try{let e=document.querySelector('input[name="logo"]').files?.[0];if(!e)return void i.oR.error("Aucun fichier s\xe9lectionn\xe9");let{data:t}=await b({variables:{logo:e}});t.updateUserLogo.success?(i.oR.success("Logo mis \xe0 jour avec succ\xe8s"),f()):i.oR.error(t.updateUserLogo.message)}catch(e){i.oR.error("Erreur lors de la mise \xe0 jour du logo")}finally{R(!1),D(!1),z(null)}},G=async(e,t)=>{if(e.new1!==e.new2)return void i.oR.error("Les nouveaux mots de passe ne correspondent pas");M(!0);try{let{data:r}=await j({variables:{oldPassword:e.old,newPassword:e.new1}});r.changePassword.success?(i.oR.success("Mot de passe modifi\xe9 avec succ\xe8s"),I(!1),t&&t()):i.oR.error(r.changePassword.message)}catch(e){i.oR.error("Erreur lors du changement de mot de passe")}finally{M(!1)}},W=()=>{N({nomInstitution:w.nomInstitution||"",nomProjets:w.nomProjet?w.nomProjet.split(",").map(e=>e.trim()).filter(Boolean):[],newProjet:"",email:w.email||"",abreviation:w.abreviation||"",logo:null})};return(0,o.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 py-8 px-4",children:[(0,o.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,o.jsx)("div",{className:"flex justify-between items-center mb-8",children:(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{className:"text-3xl font-bold text-slate-800 mb-2",children:"Mon profil"}),(0,o.jsx)("p",{className:"text-slate-600",children:"G\xe9rez vos informations personnelles et pr\xe9f\xe9rences"})]})}),(0,o.jsx)("div",{className:"bg-white rounded-3xl shadow-xl border border-white/20 backdrop-blur-sm overflow-hidden",children:(0,o.jsxs)("form",{onSubmit:S,className:"p-8",children:[(0,o.jsxs)("div",{className:"flex items-center gap-6 mb-8 pb-8 border-b border-slate-100",children:[(0,o.jsxs)("div",{className:"relative group",children:[w.logo?(0,o.jsx)("img",{src:(0,m.D1)(w.logo),alt:"Logo",className:"w-24 h-24 rounded-2xl object-cover border-4 border-white shadow-lg group-hover:shadow-xl transition-shadow"}):(0,o.jsx)("div",{className:"w-24 h-24 rounded-2xl bg-gradient-to-br from-blue-100 to-blue-200 border-4 border-white shadow-lg flex items-center justify-center",children:(0,o.jsx)("svg",{className:"w-8 h-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),(0,o.jsx)("div",{className:"absolute -bottom-2 -right-2 bg-blue-500 rounded-full p-2 shadow-lg group-hover:bg-blue-600 transition-colors",children:(0,o.jsxs)("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})})]}),(0,o.jsxs)("div",{className:"flex-1",children:[(0,o.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Photo de profil"}),(0,o.jsx)("input",{type:"file",name:"logo",accept:"image/*",onChange:q,disabled:P,className:"block w-full text-sm text-slate-500 file:mr-4 file:py-3 file:px-6 file:rounded-xl file:border-0 file:text-sm file:font-medium file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 file:transition-colors"}),(0,o.jsx)("p",{className:"text-xs text-slate-500 mt-2",children:"PNG, JPG ou GIF (max. 2MB)"})]})]}),(0,o.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[(0,o.jsxs)("div",{className:"space-y-2",children:[(0,o.jsx)("label",{className:"block text-sm font-semibold text-slate-700",children:"Nom de l'institution"}),(0,o.jsx)("input",{type:"text",name:"nomInstitution",value:y.nomInstitution,readOnly:!0,className:"w-full px-4 py-3 border border-slate-200 rounded-xl bg-slate-50 cursor-not-allowed text-slate-600 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-300 transition-colors"})]}),(0,o.jsxs)("div",{className:"space-y-2",children:[(0,o.jsx)("label",{className:"block text-sm font-semibold text-slate-700",children:"Email"}),(0,o.jsx)("input",{type:"email",name:"email",value:y.email,onChange:e=>{let{name:t,value:r,files:o}=e.target;N(e=>({...e,[t]:o?o[0]:r}))},disabled:!k||P,className:`w-full px-4 py-3 border rounded-xl transition-colors focus:ring-2 focus:ring-blue-500/20 focus:border-blue-300 ${!k?"border-slate-200 bg-slate-50 text-slate-600":"border-slate-300 bg-white text-slate-800"}`})]})]}),(0,o.jsxs)("div",{className:"mb-8",children:[(0,o.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-3",children:"Projets rattach\xe9s"}),(0,o.jsxs)("div",{className:"flex gap-3 mb-4",children:[(0,o.jsx)("input",{type:"text",name:"newProjet",value:y.newProjet,onChange:e=>{let t=e.target.value;if(t.endsWith(",")){let e=t.slice(0,-1).trim();e&&!y.nomProjets.includes(e)?N(t=>({...t,nomProjets:[...t.nomProjets,e],newProjet:""})):N(e=>({...e,newProjet:""}))}else N(e=>({...e,newProjet:t}))},onKeyDown:e=>{"Enter"===e.key&&O(e)},disabled:!k||P,className:`flex-1 px-4 py-3 border rounded-xl transition-colors focus:ring-2 focus:ring-blue-500/20 focus:border-blue-300 ${!k?"border-slate-200 bg-slate-50 text-slate-600":"border-slate-300 bg-white text-slate-800"}`,placeholder:"Ajouter un projet et appuyer sur Entr\xe9e ou ,"}),(0,o.jsx)("button",{type:"button",onClick:O,disabled:!k||P||!y.newProjet.trim(),className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-semibold shadow-lg hover:shadow-xl",children:(0,o.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]}),(0,o.jsx)("div",{className:"flex flex-wrap gap-3",children:y.nomProjets.map((e,t)=>(0,o.jsxs)("span",{className:"bg-gradient-to-r from-blue-100 to-blue-200 text-blue-800 px-4 py-2 rounded-xl text-sm flex items-center font-medium shadow-sm",children:[e,k&&(0,o.jsx)("button",{type:"button",onClick:()=>U(e),className:"ml-2 text-blue-800 hover:text-red-600 transition-colors p-1 rounded-full hover:bg-white/50",children:(0,o.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},t))})]}),(0,o.jsxs)("div",{className:"mb-8",children:[(0,o.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Abr\xe9viation"}),(0,o.jsx)("input",{type:"text",name:"abreviation",value:y.abreviation,readOnly:!0,maxLength:20,className:"w-full px-4 py-3 border border-slate-200 rounded-xl bg-slate-50 cursor-not-allowed text-slate-600 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-300 transition-colors"})]}),(0,o.jsx)("div",{className:"flex justify-end gap-4 pt-6 border-t border-slate-100",children:k?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("button",{type:"button",onClick:()=>{C(!1),W()},className:"px-8 py-3 bg-slate-200 text-slate-700 rounded-xl hover:bg-slate-300 font-semibold transition-colors flex items-center gap-2",children:[(0,o.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Annuler"]}),(0,o.jsx)("button",{type:"submit",disabled:P,className:"px-8 py-3 bg-green-500 text-white rounded-xl hover:bg-green-600 font-semibold shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center gap-2",children:P?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,o.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,o.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Enregistrement..."]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Enregistrer"]})})]}):(0,o.jsxs)("button",{type:"button",onClick:()=>C(!0),className:"px-8 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 font-semibold shadow-lg hover:shadow-xl transition-all duration-200 flex items-center gap-2",children:[(0,o.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Modifier"]})})]})}),(0,o.jsx)("div",{className:"mt-8 bg-white rounded-3xl shadow-xl border border-white/20 backdrop-blur-sm p-8",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"text-xl font-bold text-slate-800 mb-2",children:"S\xe9curit\xe9"}),(0,o.jsx)("p",{className:"text-slate-600",children:"Modifiez votre mot de passe pour s\xe9curiser votre compte"})]}),(0,o.jsxs)("button",{type:"button",onClick:()=>I(!0),className:"px-6 py-3 bg-slate-200 text-slate-700 rounded-xl hover:bg-slate-300 font-semibold shadow-lg hover:shadow-xl transition-all duration-200 flex items-center gap-2",children:[(0,o.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"Changer mon mot de passe"]})]})})]}),(0,o.jsx)(eg,{open:E,onOpenChange:I,onSubmit:G,loading:L}),(0,o.jsx)(c.A,{isOpen:A,onClose:()=>{D(!1),z(null)},onConfirm:()=>{"save"===_?F():"logo"===_&&B()},title:"save"===_?"Confirmer la modification":"Confirmer le changement de logo",message:"save"===_?"\xcates-vous s\xfbr de vouloir modifier vos informations de profil ?":"\xcates-vous s\xfbr de vouloir changer votre logo ?",confirmText:"Confirmer",cancelText:"Annuler"})]})}}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[176,804,829,852,899,975],()=>r(25606));module.exports=o})();