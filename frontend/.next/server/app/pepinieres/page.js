(()=>{var e={};e.id=657,e.ids=[657],e.modules={2558:(e,t,i)=>{Promise.resolve().then(i.bind(i,38405))},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},7286:(e,t,i)=>{Promise.resolve().then(i.bind(i,72933))},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},29736:(e,t,i)=>{"use strict";i.r(t),i.d(t,{GlobalError:()=>a.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d});var s=i(65239),r=i(48088),n=i(88170),a=i.n(n),l=i(30893),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);i.d(t,o);let d={children:["",{children:["pepinieres",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(i.bind(i,72933)),"C:\\Users\\Fitahiana\\Documents\\GitHub\\Agri-Geo\\frontend\\src\\app\\pepinieres\\page.js"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(i.bind(i,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(i.bind(i,75535)),"C:\\Users\\Fitahiana\\Documents\\GitHub\\Agri-Geo\\frontend\\src\\app\\layout.js"],"not-found":[()=>Promise.resolve().then(i.bind(i,28069)),"C:\\Users\\Fitahiana\\Documents\\GitHub\\Agri-Geo\\frontend\\src\\app\\not-found.js"],forbidden:[()=>Promise.resolve().then(i.t.bind(i,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(i.t.bind(i,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(i.bind(i,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["C:\\Users\\Fitahiana\\Documents\\GitHub\\Agri-Geo\\frontend\\src\\app\\pepinieres\\page.js"],u={require:i,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/pepinieres/page",pathname:"/pepinieres",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},33873:e=>{"use strict";e.exports=require("path")},35533:(e,t,i)=>{"use strict";i.d(t,{z:()=>n}),i(43210);var s=i(16189),r=i(89162);function n(e=!0){let{user:t,isAuthenticated:i,isLoading:a}=(0,r.h)();return(0,s.useRouter)(),{user:t,isAuthenticated:i,isLoading:a,isAuthorized:!e||i}}i(65222)},38405:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>q});var s=i(60687),r=i(43210),n=i(22710),a=i(8829),l=i(89162),o=i(16189),d=i(48443),c=i(35533),u=i(66362),m=i(13861),p=i(63143),x=i(96362),h=i(96474),g=i(22982),b=i(47033),f=i(14952),j=i(92049),v=i(11703),y=i(48840),N=i(16023),w=i(11860),C=i(9005);let G=({onSuccess:e,onCancel:t,initialData:i=null,mode:l="add",pepiniereId:o=null})=>{let[c,u]=(0,r.useState)({nom:"",adresse:"",latitude:"",longitude:"",description:"",nomGestionnaire:"",posteGestionnaire:"",telephoneGestionnaire:"",emailGestionnaire:"",especesProduites:"",nomProjet:"",quantiteProductionGenerale:""}),[m,p]=(0,r.useState)([]),[x,h]=(0,r.useState)(!1),{showSuccess:g,showError:b}=(0,j.d)(),[f,{loading:G}]=(0,n.n)(d.JL),[P,{loading:k}]=(0,n.n)(d.mb),{data:S}=(0,a.IT)(d.QG),A=(S?.me?.nomProjet||"").split(",").map(e=>e.trim()).filter(Boolean);(0,r.useEffect)(()=>{i&&(u({nom:i.nom||"",adresse:i.adresse||"",latitude:i.latitude||"",longitude:i.longitude||"",description:i.description||"",nomGestionnaire:i.nomGestionnaire||"",posteGestionnaire:i.posteGestionnaire||"",telephoneGestionnaire:i.telephoneGestionnaire||"",emailGestionnaire:i.emailGestionnaire||"",especesProduites:i.especesProduites||"",nomProjet:i.nomProjet||"",quantiteProductionGenerale:i.quantiteProductionGenerale||""}),i.photos&&p(i.photos.slice(0,3).map(e=>({id:e.id,url:e.image?e.image.startsWith("http")?e.image:`${"http://91.204.209.201:8000/media/".replace(/\/$/,"")}/${e.image.replace(/^\//,"")}`:"",titre:e.titre||"",description:e.description||"",isExisting:!0}))))},[i]);let z=e=>{let{name:t,value:i}=e.target;u(e=>({...e,[t]:i}))},I=e=>{p(t=>t.filter((t,i)=>i!==e))},q=(e,t,i)=>{p(s=>s.map((s,r)=>r===e?{...s,[t]:i}:s))},E=e=>{e&&"Point"===e.type&&2===e.coordinates.length?u(t=>({...t,latitude:e.coordinates[1],longitude:e.coordinates[0]})):b("Veuillez s\xe9lectionner un point sur la carte.")},[L,M]=(0,r.useState)(!1),[_,D]=(0,r.useState)(!1),V=e=>{if(e.preventDefault(),!c.nom||!c.adresse||!c.latitude||!c.longitude)return void b("Veuillez remplir tous les champs obligatoires.");M(!0)},$=async()=>{D(!0);try{let t=m.filter(e=>!e.isExisting).map(e=>e.file);if("edit"===l&&o){let{data:i}=await P({variables:{id:o,nom:c.nom,adresse:c.adresse,latitude:parseFloat(c.latitude),longitude:parseFloat(c.longitude),description:c.description,nomGestionnaire:c.nomGestionnaire,posteGestionnaire:c.posteGestionnaire,telephoneGestionnaire:c.telephoneGestionnaire,emailGestionnaire:c.emailGestionnaire,especesProduites:c.especesProduites,nomProjet:c.nomProjet,quantiteProductionGenerale:c.quantiteProductionGenerale,photos:t}});i.updatePepiniere.success?(g("P\xe9pini\xe8re mise \xe0 jour avec succ\xe8s."),e&&e()):b(i.updatePepiniere.message||"Erreur lors de la mise \xe0 jour.")}else{let{data:i}=await f({variables:{nom:c.nom,adresse:c.adresse,latitude:parseFloat(c.latitude),longitude:parseFloat(c.longitude),description:c.description,nomGestionnaire:c.nomGestionnaire,posteGestionnaire:c.posteGestionnaire,telephoneGestionnaire:c.telephoneGestionnaire,emailGestionnaire:c.emailGestionnaire,especesProduites:c.especesProduites,nomProjet:c.nomProjet,quantiteProductionGenerale:c.quantiteProductionGenerale,photos:t}});i.createPepiniere.success?(g("P\xe9pini\xe8re cr\xe9\xe9e avec succ\xe8s."),e&&e()):b(i.createPepiniere.message||"Erreur lors de la cr\xe9ation.")}M(!1)}catch(e){b("Erreur lors de la soumission de la p\xe9pini\xe8re."),console.error("Erreur lors de la soumission:",e)}finally{D(!1)}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"bg-white border-b border-gray-200 p-6 rounded-t-lg",children:(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"edit"===l?"Modifier la p\xe9pini\xe8re":"Ajouter une p\xe9pini\xe8re"})}),(0,s.jsx)("div",{className:"bg-white overflow-y-auto max-h-[60vh]",children:(0,s.jsx)("div",{className:"p-6",children:(0,s.jsxs)("form",{onSubmit:V,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom *"}),(0,s.jsx)("input",{type:"text",name:"nom",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",value:c.nom,onChange:z})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom du projet"}),(0,s.jsxs)("select",{name:"nomProjet",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",value:c.nomProjet,onChange:z,children:[(0,s.jsx)("option",{value:"",children:"S\xe9lectionner un projet"}),A.map((e,t)=>(0,s.jsx)("option",{value:e,children:e},t))]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Adresse *"}),(0,s.jsx)("input",{type:"text",name:"adresse",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",value:c.adresse,onChange:z})]}),(0,s.jsxs)("div",{className:"flex gap-2 items-end",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Latitude *"}),(0,s.jsx)("input",{type:"number",step:"0.000001",name:"latitude",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",value:c.latitude,onChange:z})]}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Longitude *"}),(0,s.jsx)("input",{type:"number",step:"0.000001",name:"longitude",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",value:c.longitude,onChange:z})]}),(0,s.jsx)("button",{type:"button",onClick:()=>h(!0),className:"ml-2 px-3 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:"S\xe9lectionner sur la carte"})]}),(0,s.jsxs)("div",{className:"border-t pt-4",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Informations du gestionnaire"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom du gestionnaire"}),(0,s.jsx)("input",{type:"text",name:"nomGestionnaire",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",value:c.nomGestionnaire,onChange:z})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Poste du gestionnaire"}),(0,s.jsx)("input",{type:"text",name:"posteGestionnaire",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",value:c.posteGestionnaire,onChange:z})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"T\xe9l\xe9phone du gestionnaire"}),(0,s.jsx)("input",{type:"tel",name:"telephoneGestionnaire",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",value:c.telephoneGestionnaire,onChange:z})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email du gestionnaire"}),(0,s.jsx)("input",{type:"email",name:"emailGestionnaire",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",value:c.emailGestionnaire,onChange:z})]})]})]}),(0,s.jsxs)("div",{className:"border-t pt-4",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Informations de production"}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Esp\xe8ces produites"}),(0,s.jsx)("textarea",{name:"especesProduites",rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",value:c.especesProduites,onChange:z,placeholder:"Liste des esp\xe8ces produites"})]})}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quantit\xe9 de production g\xe9n\xe9rale"}),(0,s.jsx)("textarea",{name:"quantiteProductionGenerale",rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",value:c.quantiteProductionGenerale,onChange:z,placeholder:"Description de la production g\xe9n\xe9rale"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,s.jsx)("textarea",{name:"description",rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",value:c.description,onChange:z})]}),(0,s.jsxs)("div",{className:"border-t pt-4",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Photos de la p\xe9pini\xe8re (max 3)"}),(0,s.jsxs)("div",{className:"space-y-4",children:[m.length<2&&(0,s.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[(0,s.jsx)(N.A,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsxs)("label",{htmlFor:"photo-upload",className:"cursor-pointer",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-indigo-600 hover:text-indigo-500",children:"Cliquez pour ajouter une photo"}),(0,s.jsx)("input",{id:"photo-upload",type:"file",accept:"image/*",multiple:!0,onChange:e=>{let t=Array.from(e.target.files);if(m.length+t.length>3)return void b("Vous pouvez ajouter au maximum 3 photos.");let i=t.map(e=>({file:e,url:URL.createObjectURL(e),titre:"",description:"",isExisting:!1}));p(e=>[...e,...i].slice(0,3))},className:"hidden"})]})}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"PNG, JPG jusqu'\xe0 10MB"})]}),m.length>0&&(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:m.map((e,t)=>(0,s.jsxs)("div",{className:"relative border rounded-lg p-4",children:[(0,s.jsx)("button",{type:"button",onClick:()=>I(t),className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",children:(0,s.jsx)(w.A,{size:16})}),(0,s.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,s.jsx)(C.A,{className:"h-8 w-8 text-gray-400"}),(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)("input",{type:"text",placeholder:"Titre de la photo",value:e.titre,onChange:e=>q(t,"titre",e.target.value),className:"w-full text-sm border border-gray-300 rounded px-2 py-1"})})]}),(0,s.jsx)("img",{src:e.url,alt:e.titre||"Photo de la p\xe9pini\xe8re",className:"w-full h-32 object-cover rounded"}),(0,s.jsx)("textarea",{placeholder:"Description de la photo",value:e.description,onChange:e=>q(t,"description",e.target.value),className:"w-full mt-2 text-sm border border-gray-300 rounded px-2 py-1 resize-none",rows:"2"})]},t))})]})]})]})})}),(0,s.jsx)("div",{className:"bg-white border-t border-gray-200 p-6 rounded-b-lg",children:(0,s.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,s.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Annuler"}),(0,s.jsx)("button",{onClick:V,disabled:G||k,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:opacity-50",children:G||k?(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"edit"===l?"Mise \xe0 jour...":"Cr\xe9ation..."]}):"edit"===l?"Mettre \xe0 jour":"Cr\xe9er la p\xe9pini\xe8re"})]})}),x&&(0,s.jsx)(y.A,{open:x,onClose:()=>h(!1),onSave:e=>{E(e),h(!1)},initialPosition:c.latitude&&c.longitude?[parseFloat(c.latitude),parseFloat(c.longitude)]:null}),L&&(0,s.jsx)(v.A,{isOpen:L,onClose:()=>M(!1),onConfirm:$,title:"edit"===l?"Confirmer la modification":"Confirmer la cr\xe9ation",message:"edit"===l?"Voulez-vous vraiment modifier cette p\xe9pini\xe8re ?":"Voulez-vous vraiment cr\xe9er cette p\xe9pini\xe8re ?",confirmText:"edit"===l?"Mettre \xe0 jour":"Cr\xe9er",confirmButtonClass:_?"bg-indigo-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700",cancelButtonClass:_?"cursor-not-allowed":"bg-gray-300 hover:bg-gray-400",confirmDisabled:_,confirmLoading:_})]})},P=({open:e,onClose:t,onSuccess:i,initialData:r=null,mode:n="add",pepiniereId:a=null})=>e?(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-2xl p-0 max-w-4xl w-full max-h-[90vh] overflow-y-auto relative animate-fade-in",children:[(0,s.jsx)("button",{onClick:t,className:"absolute top-2 right-2 text-gray-400 hover:text-gray-700 text-2xl font-bold focus:outline-none z-10","aria-label":"Fermer",children:"\xd7"}),(0,s.jsx)(G,{onSuccess:e=>{i&&i(e),t&&t()},onCancel:t,initialData:r,mode:n,pepiniereId:a})]})}):null;var k=i(30120),S=i(32168),A=i(76717),z=i(36713),I=i(79887);function q(){let{isLoading:e,isAuthorized:t}=(0,c.z)(!0),{user:i,isAuthenticated:y,isLoading:N}=(0,l.h)(),w=(0,o.useRouter)(),[C]=(0,r.useState)(null),[G,q]=(0,r.useState)(!1),[E,L]=(0,r.useState)(!1),[M]=(0,r.useState)(""),[_]=(0,r.useState)("nom"),[D]=(0,r.useState)("asc"),[V,$]=(0,r.useState)(1),[F,H]=(0,r.useState)(10),[R,U]=(0,r.useState)("street"),[W,O]=(0,r.useState)([{key:"nom",label:"P\xe9pini\xe8re"},{key:"adresse",label:"Adresse"},{key:"nomGestionnaire",label:"Gestionnaire"},{key:"nomProjet",label:"Projet rattach\xe9"}].map(e=>e.key)),{showSuccess:B,showError:T}=(0,j.d)(),[Q,K]=(0,r.useState)(null),[J]=(0,n.n)(d.kv),[X,Z]=(0,r.useState)(!1),[Y,ee]=(0,r.useState)(!1),[et,ei]=(0,r.useState)(!1),[es,er]=(0,r.useState)(null),[en,ea]=(0,r.useState)(!1),[el,eo]=(0,r.useState)(null),[ed,ec]=(0,r.useState)(!1),{data:eu,loading:em,refetch:ep}=(0,a.IT)(d.z7,{skip:!y||i&&("ADMIN"===i.role||"admin"===i.role)}),ex=eu?.myPepinieres||[];if(e||!t)return(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:e?"V\xe9rification de l'authentification...":"Redirection vers la page de connexion..."})]})});if(!N&&(!y||!i||"ADMIN"===i.role||"admin"===i.role))return w.push("/"),null;let eh=e=>{K(e),ee(!0)},eg=e=>{eo(e),ea(!0)},eb=async()=>{if(el){ec(!0);try{let{data:e}=await J({variables:{id:el.id}});e.deletePepiniere.success?(B("P\xe9pini\xe8re supprim\xe9e avec succ\xe8s"),ep()):T(e.deletePepiniere.message)}catch(e){T("Erreur lors de la suppression")}finally{ec(!1),ea(!1),eo(null)}}},ef=e=>{er(e),ei(!0)},ej=(0,r.useMemo)(()=>{let e=ex;if(M){let t=M.toLowerCase();e=e.filter(e=>W.some(i=>{let s=e[i];return null!=s&&String(s).toLowerCase().includes(t)}))}return[...e].sort((e,t)=>{let i=e[_]||"",s=t[_]||"";return("string"==typeof i&&(i=i.toLowerCase()),"string"==typeof s&&(s=s.toLowerCase()),i<s)?"asc"===D?-1:1:i>s?"asc"===D?1:-1:0})},[ex,M,_,D,W]),ev=(0,r.useMemo)(()=>{let e=(V-1)*F;return ej.slice(e,e+F)},[ej,V,F]),ey=Math.ceil(ej.length/F),eN=(0,r.useMemo)(()=>[W.includes("nom")&&{accessorKey:"nom",header:"P\xe9pini\xe8re",cell:e=>e.getValue()},W.includes("adresse")&&{accessorKey:"adresse",header:"Adresse",cell:e=>e.getValue()},W.includes("nomGestionnaire")&&{accessorKey:"Gestionnaire",header:"Gestionnaire",cell:e=>{let t=e.row.original;return(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:t.nomGestionnaire||"-"}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:t.posteGestionnaire||"-"})]})}},W.includes("nomProjet")&&{accessorKey:"projet rattach\xe9",header:"Projet rattach\xe9",cell:e=>e.row.original.nomProjet},{id:"actions",header:()=>(0,s.jsx)("div",{className:"text-center",children:"Actions"}),cell:({row:e})=>(0,s.jsxs)("div",{className:"flex gap-2 justify-center",children:[(0,s.jsx)(A.$,{variant:"outline",size:"sm",onClick:()=>ef(e.original),title:"Voir les d\xe9tails",className:"text-blue-600 hover:text-blue-800",children:(0,s.jsx)(m.A,{size:15})}),(0,s.jsx)(A.$,{variant:"outline",size:"sm",onClick:()=>eh(e.original),title:"Modifier la p\xe9pini\xe8re",children:(0,s.jsx)(p.A,{size:15})}),(0,s.jsx)(A.$,{variant:"destructive",size:"sm",onClick:()=>eg(e.original),title:"Supprimer la p\xe9pini\xe8re",children:(0,s.jsx)(x.A,{size:15})}),(0,s.jsx)(v.A,{open:en,title:"Confirmer la suppression",description:el?`\xcates-vous s\xfbr de vouloir supprimer la p\xe9pini\xe8re \xab ${el.nom} \xbb ? Cette action est irr\xe9versible.`:"",confirmLabel:ed?"Suppression...":"Supprimer",cancelLabel:"Annuler",onCancel:()=>{ea(!1),eo(null)},onConfirm:eb,loading:ed,variant:"destructive"})]}),enableSorting:!1,enableHiding:!1}].filter(Boolean),[W]),ew=(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)(z.l6,{value:String(F),onValueChange:e=>{H(Number(e)),$(1)},children:[(0,s.jsx)(z.bq,{className:"w-32",children:(0,s.jsx)(z.yv,{placeholder:"Lignes par page"})}),(0,s.jsx)(z.gC,{children:[10,25,50].map(e=>(0,s.jsxs)(z.eb,{value:String(e),children:[e," par page"]},e))})]})});return(0,s.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-center gap-4 mb-6",children:[(0,s.jsxs)("div",{className:"flex-shrink-0",children:[(0,s.jsx)("h1",{className:"text-2xl lg:text-3xl font-extrabold midnight-blue-text drop-shadow-sm",children:"Mes p\xe9pini\xe8res"}),(0,s.jsxs)("p",{className:"text-gray-700 mt-1 font-medium text-sm lg:text-base",children:[ex.length," p\xe9pini\xe8re",1!==ex.length?"s":""," au total"]})]}),!(G||E)&&(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3",children:[(0,s.jsxs)(A.$,{onClick:()=>{K(null),ee(!0)},className:"px-4 py-2 midnight-blue-btn rounded-md shadow font-bold transition flex items-center justify-center gap-2 text-sm",title:"Ajouter une nouvelle p\xe9pini\xe8re",children:[(0,s.jsx)(h.A,{size:16})," Ajouter une p\xe9pini\xe8re"]}),(0,s.jsxs)(A.$,{onClick:()=>Z(!0),className:"px-4 py-2 midnight-blue-btn rounded-md shadow font-bold transition flex items-center justify-center gap-2 text-sm",title:"Import/Export CSV",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Import/Export CSV"]})]}),(G||E)&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("select",{value:R,onChange:e=>U(e.target.value),className:"px-3 py-2 border midnight-blue-border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-200 bg-white midnight-blue-text font-semibold shadow-sm text-sm",children:[(0,s.jsx)("option",{value:"street",children:"Carte routi\xe8re"}),(0,s.jsx)("option",{value:"satellite",children:"Satellite"}),(0,s.jsx)("option",{value:"hybrid",children:"Hybride"})]}),!E&&(0,s.jsx)(A.$,{onClick:()=>L(!0),className:"px-3 py-2 midnight-blue-btn rounded-md font-semibold shadow-sm transition text-sm",title:"Afficher la carte en plein \xe9cran",children:"Plein \xe9cran"}),E&&(0,s.jsx)(A.$,{onClick:()=>L(!1),className:"px-3 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 font-semibold shadow-sm transition text-sm",title:"Quitter le plein \xe9cran",children:"Quitter"})]})]})}),G||E?(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,s.jsx)("div",{className:"flex justify-end mb-2",children:(0,s.jsxs)(A.$,{onClick:()=>q(!1),variant:"outline",className:"px-3 py-2 rounded-md border midnight-blue-border bg-white midnight-blue-text hover:bg-blue-50 flex items-center gap-2 shadow-sm transition font-semibold text-sm",children:[(0,s.jsx)(g.A,{size:16}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Voir le tableau"}),(0,s.jsx)("span",{className:"sm:hidden",children:"Tableau"})]})}),(0,s.jsx)("div",{className:E?"fixed inset-0 z-50 bg-white bg-opacity-95 flex items-center justify-center":"bg-white rounded-lg shadow-lg overflow-hidden",style:E?{height:"100vh",width:"100vw"}:{},children:(0,s.jsxs)("div",{className:E?"w-full h-full flex flex-col bg-white rounded-none shadow-none relative":"bg-white rounded-lg shadow-lg overflow-hidden",style:E?{maxWidth:"100vw",maxHeight:"100vh"}:{},children:[E&&(0,s.jsx)(A.$,{onClick:()=>L(!1),className:"absolute top-4 right-4 z-50 px-4 py-2 bg-gray-700 text-white rounded-xl shadow-lg hover:bg-gray-900 font-bold transition",title:"Quitter le plein \xe9cran",children:"Quitter plein \xe9cran"}),(0,s.jsxs)("div",{className:"p-4 border-b",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Carte des p\xe9pini\xe8res"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[ex.length," p\xe9pini\xe8re",1!==ex.length?"s":""," affich\xe9e",1!==ex.length?"s":""," sur la carte"]})]}),(0,s.jsx)("div",{style:E?{flex:1,minHeight:0,minWidth:0}:{height:"600px",width:"100%"},children:em?(0,s.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-2 text-gray-600",children:"Chargement de la carte..."})]})}):(0,s.jsx)(k.A,{pepinieres:ex,onPepiniereClick:C,mapStyle:R,style:{height:"100%",minHeight:400}})})]})})]}):(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,s.jsx)("div",{className:"flex justify-end mb-2",children:(0,s.jsxs)(A.$,{onClick:()=>q(!0),variant:"outline",className:"midnight-blue-text midnight-blue-border border rounded-md hover:bg-blue-50 flex items-center justify-center gap-2 font-bold transition text-sm shadow-sm",title:"Voir la carte",children:[(0,s.jsx)(g.A,{size:16}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Voir la carte"}),(0,s.jsx)("span",{className:"sm:hidden",children:"Carte"})]})}),(0,s.jsxs)("div",{className:"bg-white rounded-b-lg shadow-lg overflow-hidden",children:[(0,s.jsx)(S.b,{columns:eN,data:ev,filterKey:"nom",filterPlaceholder:"Rechercher par nom...",actions:ew}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-3 p-4 bg-gradient-to-r from-blue-50 to-blue-100 rounded-b-2xl border-t border-blue-100",children:[(0,s.jsxs)("div",{className:"text-sm text-blue-900 font-semibold",children:["Page ",V," sur ",ey]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(A.$,{variant:"outline",size:"sm",disabled:1===V,onClick:()=>$(V-1),className:"flex items-center gap-1",children:[(0,s.jsx)(b.A,{size:14})," ",(0,s.jsx)("span",{className:"hidden sm:inline",children:"Pr\xe9c\xe9dent"})]}),(0,s.jsxs)(A.$,{variant:"outline",size:"sm",disabled:V===ey,onClick:()=>$(V+1),className:"flex items-center gap-1",children:[(0,s.jsx)("span",{className:"hidden sm:inline",children:"Suivant"})," ",(0,s.jsx)(f.A,{size:14})]})]})]})]}),(0,s.jsx)(P,{open:Y,onClose:()=>{ee(!1),K(null)},initialData:Q,mode:Q?"edit":"add",pepiniereId:Q?Q.id:null,onSuccess:()=>{ee(!1),K(null),ep()}}),X&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-2xl max-w-2xl w-full p-6 relative",children:[(0,s.jsx)(A.$,{onClick:()=>Z(!1),className:"absolute top-4 right-4 text-gray-500 hover:text-gray-800 text-xl font-bold",title:"Fermer",children:"\xd7"}),(0,s.jsx)(u.A,{onImportSuccess:()=>{Z(!1),ep()}})]})}),et&&es&&(0,s.jsx)(I.A,{pepiniere:es,onClose:()=>{ei(!1),er(null)}})]})]})}},48840:(e,t,i)=>{"use strict";i.d(t,{A:()=>b});var s=i(60687),r=i(43210),n=i(19496),a=i(47594),l=i(61467),o=i(27321),d=i(91299),c=i(97638),u=i.n(c);let m=(0,o.Nq)(function({position:e,...t},i){let s=new c.Marker(e,t);return(0,d.Q)(s,(0,n.W4)(i,{overlayContainer:s}))},function(e,t,i){t.position!==i.position&&e.setLatLng(t.position),null!=t.icon&&t.icon!==i.icon&&e.setIcon(t.icon),null!=t.zIndexOffset&&t.zIndexOffset!==i.zIndexOffset&&e.setZIndexOffset(t.zIndexOffset),null!=t.opacity&&t.opacity!==i.opacity&&e.setOpacity(t.opacity),null!=e.dragging&&t.draggable!==i.draggable&&(!0===t.draggable?e.dragging.enable():e.dragging.disable())});i(63245);let p={position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},x={background:"white",borderRadius:"8px",padding:"24px",width:"600px",minWidth:"350px",height:"500px",minHeight:"400px",maxWidth:"90vw",maxHeight:"90vh",display:"flex",flexDirection:"column"},h=new(u()).Icon({iconUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});function g({position:e,setPosition:t}){return!function(e){let t=(0,n.U$)().map;(0,r.useEffect)(function(){return t.on(e),function(){t.off(e)}},[t,e])}({click(e){t([e.latlng.lat,e.latlng.lng])}}),null}let b=({open:e,onClose:t,onSave:i,initialPosition:n})=>{let[o,d]=(0,r.useState)(n||null),[c,u]=(0,r.useState)("standard");return e?(0,s.jsx)("div",{style:{...p,zIndex:1e3},children:(0,s.jsxs)("div",{style:{...x,width:"100vw",minWidth:"100vw",height:"100vh",minHeight:"100vh",maxWidth:"100vw",maxHeight:"100vh",padding:0,boxSizing:"border-box",display:"flex",flexDirection:"column"},children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",style:{padding:"16px 24px 0 24px"},children:[(0,s.jsx)("h2",{className:"text-lg font-bold",children:"S\xe9lectionner la position du si\xe8ge"}),(0,s.jsx)("div",{className:"flex items-center space-x-2",children:(0,s.jsxs)("select",{value:c,onChange:e=>u(e.target.value),className:"px-2 py-1 border border-gray-300 rounded-md text-gray-700 bg-white hover:bg-gray-100",style:{fontSize:"0.95em"},children:[(0,s.jsx)("option",{value:"standard",children:"Standard"}),(0,s.jsx)("option",{value:"satellite",children:"Satellite + labels"})]})})]}),(0,s.jsx)("div",{style:{flex:1,minHeight:0},children:(0,s.jsxs)(a.W,{center:o||[-19,47],zoom:o?12:6,style:{height:"100%",width:"100%"},children:["standard"===c&&(0,s.jsx)(l.e,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:"\xa9 OpenStreetMap contributors"}),"satellite"===c&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.e,{url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles \xa9 Esri — Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"}),(0,s.jsx)(l.e,{url:"https://server.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",attribution:"Labels \xa9 Esri"})]}),(0,s.jsx)(g,{position:o,setPosition:d}),o&&(0,s.jsx)(m,{position:o,icon:h})]})}),(0,s.jsxs)("div",{className:"flex justify-end mt-4 space-x-2",style:{background:"white",padding:"0 24px 24px 24px",borderBottomLeftRadius:8,borderBottomRightRadius:8,boxShadow:"0 -2px 8px rgba(0,0,0,0.04)"},children:[(0,s.jsx)("button",{onClick:t,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Annuler"}),(0,s.jsx)("button",{onClick:()=>{o&&(i({type:"Point",coordinates:[o[1],o[0]]}),t())},disabled:!o,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50",children:"Valider"})]})]})}):null}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},72933:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>s});let s=(0,i(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\Fitahiana\\\\Documents\\\\GitHub\\\\Agri-Geo\\\\frontend\\\\src\\\\app\\\\pepinieres\\\\page.js\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\Fitahiana\\Documents\\GitHub\\Agri-Geo\\frontend\\src\\app\\pepinieres\\page.js","default")},79551:e=>{"use strict";e.exports=require("url")}};var t=require("../../webpack-runtime.js");t.C(e);var i=e=>t(t.s=e),s=t.X(0,[447,575,804,829,995,852,349,111,498,975,887,946,589],()=>i(29736));module.exports=s})();