(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3657],{2794:(e,i,t)=>{Promise.resolve().then(t.bind(t,4676))},4676:(e,i,t)=>{"use strict";t.r(i),t.d(i,{default:()=>L});var s=t(5155),n=t(2115),r=t(8095),l=t(1929),a=t(6254),o=t(5695),d=t(3593),c=t(5489),m=t(8048),u=t(2657),x=t(3717),p=t(4126),h=t(4616),g=t(3578),b=t(2355),f=t(3052),j=t(5369),v=t(3225),y=t(8565),N=t(9869),w=t(4416),C=t(7213);let P=e=>{var i;let{onSuccess:t,onCancel:a,initialData:o=null,mode:c="add",pepiniereId:m=null}=e,[u,x]=(0,n.useState)({nom:"",adresse:"",latitude:"",longitude:"",description:"",nomGestionnaire:"",posteGestionnaire:"",telephoneGestionnaire:"",emailGestionnaire:"",especesProduites:"",nomProjet:"",quantiteProductionGenerale:""}),[p,h]=(0,n.useState)([]),[g,b]=(0,n.useState)(!1),{showSuccess:f,showError:P}=(0,j.d)(),[G,{loading:k}]=(0,r.n)(d.JL),[S,{loading:A}]=(0,r.n)(d.mb),{data:z}=(0,l.IT)(d.QG),E=((null==z||null==(i=z.me)?void 0:i.nomProjet)||"").split(",").map(e=>e.trim()).filter(Boolean);(0,n.useEffect)(()=>{if(o&&(x({nom:o.nom||"",adresse:o.adresse||"",latitude:o.latitude||"",longitude:o.longitude||"",description:o.description||"",nomGestionnaire:o.nomGestionnaire||"",posteGestionnaire:o.posteGestionnaire||"",telephoneGestionnaire:o.telephoneGestionnaire||"",emailGestionnaire:o.emailGestionnaire||"",especesProduites:o.especesProduites||"",nomProjet:o.nomProjet||"",quantiteProductionGenerale:o.quantiteProductionGenerale||""}),o.photos)){let e="".concat("http://91.204.209.201:8000","/media/")||0;h(o.photos.slice(0,3).map(i=>({id:i.id,url:i.image?i.image.startsWith("http")?i.image:"".concat(e.replace(/\/$/,""),"/").concat(i.image.replace(/^\//,"")):"",titre:i.titre||"",description:i.description||"",isExisting:!0})))}},[o]);let L=e=>{let{name:i,value:t}=e.target;x(e=>({...e,[i]:t}))},V=e=>{h(i=>i.filter((i,t)=>t!==e))},q=(e,i,t)=>{h(s=>s.map((s,n)=>n===e?{...s,[i]:t}:s))},M=e=>{e&&"Point"===e.type&&2===e.coordinates.length?x(i=>({...i,latitude:e.coordinates[1],longitude:e.coordinates[0]})):P("Veuillez s\xe9lectionner un point sur la carte.")},[$,I]=(0,n.useState)(!1),[F,D]=(0,n.useState)(!1),H=e=>{if(e.preventDefault(),!u.nom||!u.adresse||!u.latitude||!u.longitude)return void P("Veuillez remplir tous les champs obligatoires.");I(!0)},T=async()=>{D(!0);try{let e=p.filter(e=>!e.isExisting).map(e=>e.file);if("edit"===c&&m){let{data:i}=await S({variables:{id:m,nom:u.nom,adresse:u.adresse,latitude:parseFloat(u.latitude),longitude:parseFloat(u.longitude),description:u.description,nomGestionnaire:u.nomGestionnaire,posteGestionnaire:u.posteGestionnaire,telephoneGestionnaire:u.telephoneGestionnaire,emailGestionnaire:u.emailGestionnaire,especesProduites:u.especesProduites,nomProjet:u.nomProjet,quantiteProductionGenerale:u.quantiteProductionGenerale,photos:e}});i.updatePepiniere.success?(f("P\xe9pini\xe8re mise \xe0 jour avec succ\xe8s."),t&&t()):P(i.updatePepiniere.message||"Erreur lors de la mise \xe0 jour.")}else{let{data:i}=await G({variables:{nom:u.nom,adresse:u.adresse,latitude:parseFloat(u.latitude),longitude:parseFloat(u.longitude),description:u.description,nomGestionnaire:u.nomGestionnaire,posteGestionnaire:u.posteGestionnaire,telephoneGestionnaire:u.telephoneGestionnaire,emailGestionnaire:u.emailGestionnaire,especesProduites:u.especesProduites,nomProjet:u.nomProjet,quantiteProductionGenerale:u.quantiteProductionGenerale,photos:e}});i.createPepiniere.success?(f("P\xe9pini\xe8re cr\xe9\xe9e avec succ\xe8s."),t&&t()):P(i.createPepiniere.message||"Erreur lors de la cr\xe9ation.")}I(!1)}catch(e){P("Erreur lors de la soumission de la p\xe9pini\xe8re."),console.error("Erreur lors de la soumission:",e)}finally{D(!1)}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"bg-white border-b border-gray-200 p-6 rounded-t-lg",children:(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"edit"===c?"Modifier la p\xe9pini\xe8re":"Ajouter une p\xe9pini\xe8re"})}),(0,s.jsx)("div",{className:"bg-white overflow-y-auto max-h-[60vh]",children:(0,s.jsx)("div",{className:"p-6",children:(0,s.jsxs)("form",{onSubmit:H,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom *"}),(0,s.jsx)("input",{type:"text",name:"nom",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",value:u.nom,onChange:L})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom du projet"}),(0,s.jsxs)("select",{name:"nomProjet",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",value:u.nomProjet,onChange:L,children:[(0,s.jsx)("option",{value:"",children:"S\xe9lectionner un projet"}),E.map((e,i)=>(0,s.jsx)("option",{value:e,children:e},i))]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Adresse *"}),(0,s.jsx)("input",{type:"text",name:"adresse",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",value:u.adresse,onChange:L})]}),(0,s.jsxs)("div",{className:"flex gap-2 items-end",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Latitude *"}),(0,s.jsx)("input",{type:"number",step:"0.000001",name:"latitude",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",value:u.latitude,onChange:L})]}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Longitude *"}),(0,s.jsx)("input",{type:"number",step:"0.000001",name:"longitude",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",value:u.longitude,onChange:L})]}),(0,s.jsx)("button",{type:"button",onClick:()=>b(!0),className:"ml-2 px-3 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:"S\xe9lectionner sur la carte"})]}),(0,s.jsxs)("div",{className:"border-t pt-4",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Informations du gestionnaire"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom du gestionnaire"}),(0,s.jsx)("input",{type:"text",name:"nomGestionnaire",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",value:u.nomGestionnaire,onChange:L})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Poste du gestionnaire"}),(0,s.jsx)("input",{type:"text",name:"posteGestionnaire",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",value:u.posteGestionnaire,onChange:L})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"T\xe9l\xe9phone du gestionnaire"}),(0,s.jsx)("input",{type:"tel",name:"telephoneGestionnaire",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",value:u.telephoneGestionnaire,onChange:L})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email du gestionnaire"}),(0,s.jsx)("input",{type:"email",name:"emailGestionnaire",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",value:u.emailGestionnaire,onChange:L})]})]})]}),(0,s.jsxs)("div",{className:"border-t pt-4",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Informations de production"}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Esp\xe8ces produites"}),(0,s.jsx)("textarea",{name:"especesProduites",rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",value:u.especesProduites,onChange:L,placeholder:"Liste des esp\xe8ces produites"})]})}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quantit\xe9 de production g\xe9n\xe9rale"}),(0,s.jsx)("textarea",{name:"quantiteProductionGenerale",rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",value:u.quantiteProductionGenerale,onChange:L,placeholder:"Description de la production g\xe9n\xe9rale"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,s.jsx)("textarea",{name:"description",rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",value:u.description,onChange:L})]}),(0,s.jsxs)("div",{className:"border-t pt-4",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Photos de la p\xe9pini\xe8re (max 3)"}),(0,s.jsxs)("div",{className:"space-y-4",children:[p.length<2&&(0,s.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[(0,s.jsx)(N.A,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsxs)("label",{htmlFor:"photo-upload",className:"cursor-pointer",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-indigo-600 hover:text-indigo-500",children:"Cliquez pour ajouter une photo"}),(0,s.jsx)("input",{id:"photo-upload",type:"file",accept:"image/*",multiple:!0,onChange:e=>{let i=Array.from(e.target.files);if(p.length+i.length>3)return void P("Vous pouvez ajouter au maximum 3 photos.");let t=i.map(e=>({file:e,url:URL.createObjectURL(e),titre:"",description:"",isExisting:!1}));h(e=>[...e,...t].slice(0,3))},className:"hidden"})]})}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"PNG, JPG jusqu'\xe0 10MB"})]}),p.length>0&&(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:p.map((e,i)=>(0,s.jsxs)("div",{className:"relative border rounded-lg p-4",children:[(0,s.jsx)("button",{type:"button",onClick:()=>V(i),className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",children:(0,s.jsx)(w.A,{size:16})}),(0,s.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,s.jsx)(C.A,{className:"h-8 w-8 text-gray-400"}),(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)("input",{type:"text",placeholder:"Titre de la photo",value:e.titre,onChange:e=>q(i,"titre",e.target.value),className:"w-full text-sm border border-gray-300 rounded px-2 py-1"})})]}),(0,s.jsx)("img",{src:e.url,alt:e.titre||"Photo de la p\xe9pini\xe8re",className:"w-full h-32 object-cover rounded"}),(0,s.jsx)("textarea",{placeholder:"Description de la photo",value:e.description,onChange:e=>q(i,"description",e.target.value),className:"w-full mt-2 text-sm border border-gray-300 rounded px-2 py-1 resize-none",rows:"2"})]},i))})]})]})]})})}),(0,s.jsx)("div",{className:"bg-white border-t border-gray-200 p-6 rounded-b-lg",children:(0,s.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,s.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Annuler"}),(0,s.jsx)("button",{onClick:H,disabled:k||A,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:opacity-50",children:k||A?(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"edit"===c?"Mise \xe0 jour...":"Cr\xe9ation..."]}):"edit"===c?"Mettre \xe0 jour":"Cr\xe9er la p\xe9pini\xe8re"})]})}),g&&(0,s.jsx)(y.A,{open:g,onClose:()=>b(!1),onSave:e=>{M(e),b(!1)},initialPosition:u.latitude&&u.longitude?[parseFloat(u.latitude),parseFloat(u.longitude)]:null}),$&&(0,s.jsx)(v.A,{isOpen:$,onClose:()=>I(!1),onConfirm:T,title:"edit"===c?"Confirmer la modification":"Confirmer la cr\xe9ation",message:"edit"===c?"Voulez-vous vraiment modifier cette p\xe9pini\xe8re ?":"Voulez-vous vraiment cr\xe9er cette p\xe9pini\xe8re ?",confirmText:"edit"===c?"Mettre \xe0 jour":"Cr\xe9er",confirmButtonClass:F?"bg-indigo-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700",cancelButtonClass:F?"cursor-not-allowed":"bg-gray-300 hover:bg-gray-400",confirmDisabled:F,confirmLoading:F})]})},G=e=>{let{open:i,onClose:t,onSuccess:n,initialData:r=null,mode:l="add",pepiniereId:a=null}=e;return i?(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-2xl p-0 max-w-4xl w-full max-h-[90vh] overflow-y-auto relative animate-fade-in",children:[(0,s.jsx)("button",{onClick:t,className:"absolute top-2 right-2 text-gray-400 hover:text-gray-700 text-2xl font-bold focus:outline-none z-10","aria-label":"Fermer",children:"\xd7"}),(0,s.jsx)(P,{onSuccess:e=>{n&&n(e),t&&t()},onCancel:t,initialData:r,mode:l,pepiniereId:a})]})}):null};var k=t(7624),S=t(6927),A=t(183),z=t(7075),E=t(5753);function L(){let{isLoading:e,isAuthorized:i}=(0,c.z)(!0),{user:t,isAuthenticated:y,isLoading:N}=(0,a.h)(),w=(0,o.useRouter)(),[C]=(0,n.useState)(null),[P,L]=(0,n.useState)(!1),[V,q]=(0,n.useState)(!1),[M]=(0,n.useState)(""),[$]=(0,n.useState)("nom"),[I]=(0,n.useState)("asc"),[F,D]=(0,n.useState)(1),[H,T]=(0,n.useState)(10),[B,Q]=(0,n.useState)("street"),[_,K]=(0,n.useState)([{key:"nom",label:"P\xe9pini\xe8re"},{key:"adresse",label:"Adresse"},{key:"nomGestionnaire",label:"Gestionnaire"},{key:"nomProjet",label:"Projet rattach\xe9"}].map(e=>e.key)),{showSuccess:R,showError:O}=(0,j.d)(),[W,J]=(0,n.useState)(null),[U]=(0,r.n)(d.kv),[X,Y]=(0,n.useState)(!1),[Z,ee]=(0,n.useState)(!1),[ei,et]=(0,n.useState)(!1),[es,en]=(0,n.useState)(null),[er,el]=(0,n.useState)(!1),[ea,eo]=(0,n.useState)(null),[ed,ec]=(0,n.useState)(!1),{data:em,loading:eu,refetch:ex}=(0,l.IT)(d.z7,{skip:!y||t&&("ADMIN"===t.role||"admin"===t.role)}),ep=(null==em?void 0:em.myPepinieres)||[];if(e||!i)return(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:e?"V\xe9rification de l'authentification...":"Redirection vers la page de connexion..."})]})});if(!N&&(!y||!t||"ADMIN"===t.role||"admin"===t.role))return w.push("/"),null;let eh=e=>{J(e),ee(!0)},eg=e=>{eo(e),el(!0)},eb=async()=>{if(ea){ec(!0);try{let{data:e}=await U({variables:{id:ea.id}});e.deletePepiniere.success?(R("P\xe9pini\xe8re supprim\xe9e avec succ\xe8s"),ex()):O(e.deletePepiniere.message)}catch(e){O("Erreur lors de la suppression")}finally{ec(!1),el(!1),eo(null)}}},ef=e=>{en(e),et(!0)},ej=(0,n.useMemo)(()=>{let e=ep;if(M){let i=M.toLowerCase();e=e.filter(e=>_.some(t=>{let s=e[t];return null!=s&&String(s).toLowerCase().includes(i)}))}return[...e].sort((e,i)=>{let t=e[$]||"",s=i[$]||"";return("string"==typeof t&&(t=t.toLowerCase()),"string"==typeof s&&(s=s.toLowerCase()),t<s)?"asc"===I?-1:1:t>s?"asc"===I?1:-1:0})},[ep,M,$,I,_]),ev=(0,n.useMemo)(()=>{let e=(F-1)*H;return ej.slice(e,e+H)},[ej,F,H]),ey=Math.ceil(ej.length/H);(0,n.useEffect)(()=>{let e=document.createElement("style");return e.innerHTML="\n      :root {\n        --midnight-blue: rgb(0,70,144);\n      }\n      .midnight-blue-bg {\n        background-color: var(--midnight-blue) !important;\n        color: #fff !important;\n      }\n      .midnight-blue-text {\n        color: var(--midnight-blue) !important;\n      }\n      .midnight-blue-border {\n        border-color: var(--midnight-blue) !important;\n      }\n      .midnight-blue-btn {\n        background-color: var(--midnight-blue) !important;\n        color: #fff !important;\n        border: 1px solid var(--midnight-blue) !important;\n      }\n      .midnight-blue-btn:hover {\n        background-color: #003366 !important;\n        color: #fff !important;\n      }\n    ",document.head.appendChild(e),()=>{document.head.removeChild(e)}},[]);let eN=(0,n.useMemo)(()=>[_.includes("nom")&&{accessorKey:"nom",header:"P\xe9pini\xe8re",cell:e=>e.getValue()},_.includes("adresse")&&{accessorKey:"adresse",header:"Adresse",cell:e=>e.getValue()},_.includes("nomGestionnaire")&&{accessorKey:"Gestionnaire",header:"Gestionnaire",cell:e=>{let i=e.row.original;return(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:i.nomGestionnaire||"-"}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:i.posteGestionnaire||"-"})]})}},_.includes("nomProjet")&&{accessorKey:"projet rattach\xe9",header:"Projet rattach\xe9",cell:e=>e.row.original.nomProjet},{id:"actions",header:()=>(0,s.jsx)("div",{className:"text-center",children:"Actions"}),cell:e=>{let{row:i}=e;return(0,s.jsxs)("div",{className:"flex gap-2 justify-center",children:[(0,s.jsx)(A.$,{variant:"outline",size:"sm",onClick:()=>ef(i.original),title:"Voir les d\xe9tails",className:"text-blue-600 hover:text-blue-800",children:(0,s.jsx)(u.A,{size:15})}),(0,s.jsx)(A.$,{variant:"outline",size:"sm",onClick:()=>eh(i.original),title:"Modifier la p\xe9pini\xe8re",children:(0,s.jsx)(x.A,{size:15})}),(0,s.jsx)(A.$,{variant:"destructive",size:"sm",onClick:()=>eg(i.original),title:"Supprimer la p\xe9pini\xe8re",children:(0,s.jsx)(p.A,{size:15})}),(0,s.jsx)(v.A,{open:er,title:"Confirmer la suppression",description:ea?"\xcates-vous s\xfbr de vouloir supprimer la p\xe9pini\xe8re \xab ".concat(ea.nom," \xbb ? Cette action est irr\xe9versible."):"",confirmLabel:ed?"Suppression...":"Supprimer",cancelLabel:"Annuler",onCancel:()=>{el(!1),eo(null)},onConfirm:eb,loading:ed,variant:"destructive"})]})},enableSorting:!1,enableHiding:!1}].filter(Boolean),[_]),ew=(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)(z.l6,{value:String(H),onValueChange:e=>{T(Number(e)),D(1)},children:[(0,s.jsx)(z.bq,{className:"w-32",children:(0,s.jsx)(z.yv,{placeholder:"Lignes par page"})}),(0,s.jsx)(z.gC,{children:[10,25,50].map(e=>(0,s.jsxs)(z.eb,{value:String(e),children:[e," par page"]},e))})]})});return(0,s.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-center gap-4 mb-6",children:[(0,s.jsxs)("div",{className:"flex-shrink-0",children:[(0,s.jsx)("h1",{className:"text-2xl lg:text-3xl font-extrabold midnight-blue-text drop-shadow-sm",children:"Mes p\xe9pini\xe8res"}),(0,s.jsxs)("p",{className:"text-gray-700 mt-1 font-medium text-sm lg:text-base",children:[ep.length," p\xe9pini\xe8re",1!==ep.length?"s":""," au total"]})]}),!(P||V)&&(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3",children:[(0,s.jsxs)(A.$,{onClick:()=>{J(null),ee(!0)},className:"px-4 py-2 midnight-blue-btn rounded-md shadow font-bold transition flex items-center justify-center gap-2 text-sm",title:"Ajouter une nouvelle p\xe9pini\xe8re",children:[(0,s.jsx)(h.A,{size:16})," Ajouter une p\xe9pini\xe8re"]}),(0,s.jsxs)(A.$,{onClick:()=>Y(!0),className:"px-4 py-2 midnight-blue-btn rounded-md shadow font-bold transition flex items-center justify-center gap-2 text-sm",title:"Import/Export CSV",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Import/Export CSV"]})]}),(P||V)&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("select",{value:B,onChange:e=>Q(e.target.value),className:"px-3 py-2 border midnight-blue-border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-200 bg-white midnight-blue-text font-semibold shadow-sm text-sm",children:[(0,s.jsx)("option",{value:"street",children:"Carte routi\xe8re"}),(0,s.jsx)("option",{value:"satellite",children:"Satellite"}),(0,s.jsx)("option",{value:"hybrid",children:"Hybride"})]}),!V&&(0,s.jsx)(A.$,{onClick:()=>q(!0),className:"px-3 py-2 midnight-blue-btn rounded-md font-semibold shadow-sm transition text-sm",title:"Afficher la carte en plein \xe9cran",children:"Plein \xe9cran"}),V&&(0,s.jsx)(A.$,{onClick:()=>q(!1),className:"px-3 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 font-semibold shadow-sm transition text-sm",title:"Quitter le plein \xe9cran",children:"Quitter"})]})]})}),P||V?(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,s.jsx)("div",{className:"flex justify-end mb-2",children:(0,s.jsxs)(A.$,{onClick:()=>L(!1),variant:"outline",className:"px-3 py-2 rounded-md border midnight-blue-border bg-white midnight-blue-text hover:bg-blue-50 flex items-center gap-2 shadow-sm transition font-semibold text-sm",children:[(0,s.jsx)(g.A,{size:16}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Voir le tableau"}),(0,s.jsx)("span",{className:"sm:hidden",children:"Tableau"})]})}),(0,s.jsx)("div",{className:V?"fixed inset-0 z-50 bg-white bg-opacity-95 flex items-center justify-center":"bg-white rounded-lg shadow-lg overflow-hidden",style:V?{height:"100vh",width:"100vw"}:{},children:(0,s.jsxs)("div",{className:V?"w-full h-full flex flex-col bg-white rounded-none shadow-none relative":"bg-white rounded-lg shadow-lg overflow-hidden",style:V?{maxWidth:"100vw",maxHeight:"100vh"}:{},children:[V&&(0,s.jsx)(A.$,{onClick:()=>q(!1),className:"absolute top-4 right-4 z-50 px-4 py-2 bg-gray-700 text-white rounded-xl shadow-lg hover:bg-gray-900 font-bold transition",title:"Quitter le plein \xe9cran",children:"Quitter plein \xe9cran"}),(0,s.jsxs)("div",{className:"p-4 border-b",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Carte des p\xe9pini\xe8res"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[ep.length," p\xe9pini\xe8re",1!==ep.length?"s":""," affich\xe9e",1!==ep.length?"s":""," sur la carte"]})]}),(0,s.jsx)("div",{style:V?{flex:1,minHeight:0,minWidth:0}:{height:"600px",width:"100%"},children:eu?(0,s.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-2 text-gray-600",children:"Chargement de la carte..."})]})}):(0,s.jsx)(k.A,{pepinieres:ep,onPepiniereClick:C,mapStyle:B,style:{height:"100%",minHeight:400}})})]})})]}):(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,s.jsx)("div",{className:"flex justify-end mb-2",children:(0,s.jsxs)(A.$,{onClick:()=>L(!0),variant:"outline",className:"midnight-blue-text midnight-blue-border border rounded-md hover:bg-blue-50 flex items-center justify-center gap-2 font-bold transition text-sm shadow-sm",title:"Voir la carte",children:[(0,s.jsx)(g.A,{size:16}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Voir la carte"}),(0,s.jsx)("span",{className:"sm:hidden",children:"Carte"})]})}),(0,s.jsxs)("div",{className:"bg-white rounded-b-lg shadow-lg overflow-hidden",children:[(0,s.jsx)(S.b,{columns:eN,data:ev,filterKey:"nom",filterPlaceholder:"Rechercher par nom...",actions:ew}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-3 p-4 bg-gradient-to-r from-blue-50 to-blue-100 rounded-b-2xl border-t border-blue-100",children:[(0,s.jsxs)("div",{className:"text-sm text-blue-900 font-semibold",children:["Page ",F," sur ",ey]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(A.$,{variant:"outline",size:"sm",disabled:1===F,onClick:()=>D(F-1),className:"flex items-center gap-1",children:[(0,s.jsx)(b.A,{size:14})," ",(0,s.jsx)("span",{className:"hidden sm:inline",children:"Pr\xe9c\xe9dent"})]}),(0,s.jsxs)(A.$,{variant:"outline",size:"sm",disabled:F===ey,onClick:()=>D(F+1),className:"flex items-center gap-1",children:[(0,s.jsx)("span",{className:"hidden sm:inline",children:"Suivant"})," ",(0,s.jsx)(f.A,{size:14})]})]})]})]}),(0,s.jsx)(G,{open:Z,onClose:()=>{ee(!1),J(null)},initialData:W,mode:W?"edit":"add",pepiniereId:W?W.id:null,onSuccess:()=>{ee(!1),J(null),ex()}}),X&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-2xl max-w-2xl w-full p-6 relative",children:[(0,s.jsx)(A.$,{onClick:()=>Y(!1),className:"absolute top-4 right-4 text-gray-500 hover:text-gray-800 text-xl font-bold",title:"Fermer",children:"\xd7"}),(0,s.jsx)(m.A,{onImportSuccess:()=>{Y(!1),ex()}})]})}),ei&&es&&(0,s.jsx)(E.A,{pepiniere:es,onClose:()=>{et(!1),en(null)}})]})]})}}},e=>{var i=i=>e(e.s=i);e.O(0,[9484,2046,1761,2871,8916,1929,9516,59,9547,6944,6800,554,5753,1411,931,8441,1684,7358],()=>i(2794)),_N_E=e.O()}]);