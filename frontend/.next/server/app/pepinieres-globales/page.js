(()=>{var e={};e.id=823,e.ids=[823],e.modules={2411:(e,t,r)=>{Promise.resolve().then(r.bind(r,58333))},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},22710:(e,t,r)=>{"use strict";r.d(t,{n:()=>u});var s=r(4363),n=r(42146),i=r(20236),a=r(29689),l=r(95803),o=r(5459),d=r(58151),c=r(62851).Sw?n.useLayoutEffect:n.useEffect;function u(e,t){var r=(0,d.m)(null==t?void 0:t.client);(0,l.D$)(e,l.KG.Mutation);var u=n.useState({called:!1,loading:!1,client:r}),p=u[0],m=u[1],x=n.useRef({result:p,mutationId:0,isMounted:!0,client:r,mutation:e,options:t});c(function(){Object.assign(x.current,{client:r,options:t,mutation:e})});var h=n.useCallback(function(e){void 0===e&&(e={});var t=x.current,r=t.options,n=t.mutation,l=(0,s.Cl)((0,s.Cl)({},r),{mutation:n}),d=e.client||x.current.client;x.current.result.loading||l.ignoreResults||!x.current.isMounted||m(x.current.result={loading:!0,error:void 0,data:void 0,called:!0,client:d});var c=++x.current.mutationId,u=(0,i.l)(l,e);return d.mutate(u).then(function(t){var r,s,n=t.data,i=t.errors,l=i&&i.length>0?new o.K4({graphQLErrors:i}):void 0,p=e.onError||(null==(r=x.current.options)?void 0:r.onError);if(l&&p&&p(l,u),c===x.current.mutationId&&!u.ignoreResults){var h={called:!0,loading:!1,data:n,error:l,client:d};x.current.isMounted&&!(0,a.L)(x.current.result,h)&&m(x.current.result=h)}var g=e.onCompleted||(null==(s=x.current.options)?void 0:s.onCompleted);return l||null==g||g(t.data,u),t},function(t){if(c===x.current.mutationId&&x.current.isMounted){var r,s={loading:!1,error:t,data:void 0,called:!0,client:d};(0,a.L)(x.current.result,s)||m(x.current.result=s)}var n=e.onError||(null==(r=x.current.options)?void 0:r.onError);if(n)return n(t,u),{data:void 0,errors:t};throw t})},[]),g=n.useCallback(function(){if(x.current.isMounted){var e={called:!1,loading:!1,client:x.current.client};Object.assign(x.current,{mutationId:0,result:e}),m(e)}},[]);return n.useEffect(function(){var e=x.current;return e.isMounted=!0,function(){e.isMounted=!1}},[]),[h,(0,s.Cl)({reset:g},p)]}},27515:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>C});var s=r(60687),n=r(43210),i=r.n(n),a=r(8829),l=r(48443),o=r(92049),d=r(54220),c=r(93661),u=r(76717),p=r(92120),m=r(65222);let x=(e,t)=>[{accessorKey:"Nom p\xe9pini\xe8re",header:({column:e})=>(0,s.jsx)("div",{className:"text-center",children:(0,s.jsxs)(u.$,{variant:"ghost",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),children:["Nom p\xe9pini\xe8re",(0,s.jsx)(d.A,{className:"ml-2 h-4 w-4"})]})}),cell:({row:e})=>(0,s.jsx)("div",{className:"text-center",children:e.original.nom})},{id:"Institutions",header:"Institutions",cell:({row:e})=>{let t=e.original.user;return(0,s.jsxs)("div",{className:"flex items-center",children:[t?.logo&&(0,s.jsx)("img",{src:(0,m.D1)(t.logo),alt:"Logo",className:"w-6 h-6 rounded-full mr-2"}),(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900",children:t?.nomInstitution})})]})}},{id:"Gestionnaire",header:"Gestionnaire",cell:({row:e})=>{let t=e.original;return(0,s.jsxs)("div",{className:"space-y-1",children:[t.nomGestionnaire&&(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900",children:t.nomGestionnaire}),t.posteGestionnaire&&(0,s.jsx)("div",{className:"text-xs text-gray-500",children:t.posteGestionnaire}),t.telephoneGestionnaire&&(0,s.jsx)("div",{className:"text-xs text-gray-500",children:t.telephoneGestionnaire}),t.emailGestionnaire&&(0,s.jsx)("div",{className:"text-xs text-gray-500",children:t.emailGestionnaire})]})}},{accessorKey:"adresse",header:()=>(0,s.jsx)("div",{className:"text-center",children:"Adresse"}),cell:({row:e})=>(0,s.jsx)("div",{className:"text-center",children:e.getValue("adresse")||"-"})},{accessorKey:"Projet rattach\xe9",header:()=>(0,s.jsx)("div",{className:"text-center",children:"Projet rattach\xe9"}),cell:({row:e})=>(0,s.jsx)("div",{className:"text-center",children:e.original.nomProjet||"-"})},{id:"actions",header:"Actions",cell:({row:r})=>(0,s.jsxs)(p.rI,{children:[(0,s.jsx)(p.ty,{asChild:!0,children:(0,s.jsxs)(u.$,{variant:"ghost",className:"h-8 w-8 p-0",children:[(0,s.jsx)("span",{className:"sr-only",children:"Ouvrir le menu"}),(0,s.jsx)(c.A,{className:"h-4 w-4"})]})}),(0,s.jsxs)(p.SQ,{align:"end",children:[(0,s.jsx)(p.lp,{children:"Actions"}),(0,s.jsx)(p._2,{onClick:()=>e(r.original),children:"Voir d\xe9tails"}),(0,s.jsx)(p._2,{onClick:()=>t(r.original),children:"Voir sur la carte"}),(0,s.jsx)(p.mB,{})]})]}),enableSorting:!1,enableHiding:!1}];var h=r(30120);let g={position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},v={background:"white",borderRadius:"8px",padding:"24px",width:"600px",minWidth:"350px",height:"500px",minHeight:"400px",maxWidth:"95vw",maxHeight:"95vh",display:"flex",flexDirection:"column"};function f({open:e,onClose:t,pepiniere:r}){let[n,a]=i().useState("street");return e&&r?(0,s.jsx)("div",{style:g,children:(0,s.jsxs)("div",{style:v,children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("h2",{className:"text-lg font-bold",children:"Voir sur la carte"}),(0,s.jsx)("button",{onClick:t,className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300",children:"Fermer"})]}),(0,s.jsxs)("div",{className:"mb-2 flex gap-2 items-center",children:[(0,s.jsx)("label",{htmlFor:"map-style",className:"font-medium",children:"Style de carte :"}),(0,s.jsxs)("select",{id:"map-style",value:n,onChange:e=>a(e.target.value),className:"px-2 py-1 border rounded",children:[(0,s.jsx)("option",{value:"street",children:"Carte routi\xe8re"}),(0,s.jsx)("option",{value:"satellite",children:"Satellite"}),(0,s.jsx)("option",{value:"hybrid",children:"Hybride"})]})]}),(0,s.jsx)("div",{style:{flex:1,minHeight:0},children:(0,s.jsx)(h.A,{pepinieres:[r],style:{height:"100%",width:"100%"},center:[parseFloat(r.latitude)||-18.7669,parseFloat(r.longitude)||46.8691],mapStyle:n})})]})}):null}var j=r(32168),b=r(79887),N=r(21426),y=r(89252),E=r(66362);function C(){let[e,t]=(0,n.useState)([]),[r,i]=(0,n.useState)([]),[d,c]=(0,n.useState)(""),{showError:p,showToast:m}=(0,o.d)(),[h,g]=(0,n.useState)(!1),[v,C]=(0,n.useState)(null),[I,S]=(0,n.useState)({open:!1,pepiniere:null}),[A,w]=(0,n.useState)(1),[P,_]=(0,n.useState)(10),{data:G,loading:T,error:R}=(0,a.IT)(l.KZ),{data:O,loading:U,error:k}=(0,a.IT)(l.em),M=r.length,D=Math.ceil(M/P),L=(A-1)*P,V=L+P,F=r.slice(L,V);if(R&&(p("Erreur lors du chargement des p\xe9pini\xe8res"),console.error("Pepinieres error:",R)),k&&(p("Erreur lors du chargement des utilisateurs"),console.error("Users error:",k)),T||U)return(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-indigo-600"})});let q=e=>{w(e)};return(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold midnight-blue-text mb-2",children:"Liste des p\xe9pini\xe8res"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Consultez toutes les p\xe9pini\xe8res de tous les institutions de la plateforme."})]}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-6",children:(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex-1 mb-4 lg:mb-0",children:[(0,s.jsx)("h3",{className:"text-lg font-medium midnight-blue-text mb-3",children:"Filtrer par institution"}),(0,s.jsx)(N.A,{users:O?.allUsers||[],selectedMembers:e,onFilterChange:e=>{t(e)}})]}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"text-lg font-medium midnight-blue-text mb-3",children:"Recherche globale"}),(0,s.jsx)("input",{type:"text",value:d,onChange:e=>{c(e.target.value)},placeholder:"Rechercher dans toutes les colonnes...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})]})}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border",children:[(0,s.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("h3",{className:"text-lg font-medium midnight-blue-text",children:["P\xe9pini\xe8res (",M,")"]}),e.length>0&&(0,s.jsxs)("span",{className:"text-sm text-gray-500",children:["Filtr\xe9 par ",e.length," Information(s)"]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("label",{htmlFor:"itemsPerPage",className:"text-sm text-gray-600",children:"Afficher:"}),(0,s.jsxs)("select",{id:"itemsPerPage",value:P,onChange:e=>{_(parseInt(e.target.value)),w(1)},className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[(0,s.jsx)("option",{value:10,children:"10"}),(0,s.jsx)("option",{value:25,children:"25"}),(0,s.jsx)("option",{value:50,children:"50"}),(0,s.jsx)("option",{value:100,children:"100"})]}),(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"lignes"})]}),(0,s.jsx)(u.$,{className:"midnight-blue-btn px-4 py-2 rounded-md font-bold text-sm",onClick:()=>{let e=new Date().toISOString().slice(0,10),t=`pepiniere_export_${e}.csv`,s=r.map(e=>({NOM:e.nom||"",INSTITUTION:e.user?.nomInstitution||"",ABREVIATION:e.user?.abreviation||"",PROJET_RATTACHE:e.nomProjet||"",ADRESSE:e.adresse||"",LATITUDE:e.latitude||"",LONGITUDE:e.longitude||"",DESCRIPTION:e.description||"",NOM_GESTIONNAIRE:e.nomGestionnaire||"",POSTE_GESTIONNAIRE:e.posteGestionnaire||"",TELEPHONE_GESTIONNAIRE:e.telephoneGestionnaire||"",EMAIL_GESTIONNAIRE:e.emailGestionnaire||"",ESPECES_PRODUITES:e.especesProduites||"",QUANTITE_PRODUCTION_GENERALE:e.quantiteProductionGenerale||"",DATE_CREATION:e.createdAt?new Date(e.createdAt).toLocaleDateString("fr-FR"):"",DERNIERE_MODIFICATION:e.updatedAt?new Date(e.updatedAt).toLocaleDateString("fr-FR"):""}));(0,y.G)(s,t)},disabled:0===r.length,children:"Exporter CSV"})]})]})}),(0,s.jsx)("div",{className:"p-6",children:(0,s.jsx)(j.b,{columns:x(e=>C(e),e=>S({open:!0,pepiniere:e})),data:F})}),D>1&&(0,s.jsx)("div",{className:"px-6 py-4 border-t border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,s.jsxs)("div",{className:"text-sm text-gray-600",children:["Affichage de ",L+1," \xe0 ",Math.min(V,M)," sur ",M," r\xe9sultats"]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("button",{onClick:()=>q(A-1),disabled:1===A,className:"pagination-btn",children:"← Pr\xe9c\xe9dent"}),(()=>{let e=[];if(D<=5)for(let t=1;t<=D;t++)e.push(t);else if(A<=3){for(let t=1;t<=4;t++)e.push(t);e.push("..."),e.push(D)}else if(A>=D-2){e.push(1),e.push("...");for(let t=D-3;t<=D;t++)e.push(t)}else{e.push(1),e.push("...");for(let t=A-1;t<=A+1;t++)e.push(t);e.push("..."),e.push(D)}return e})().map((e,t)=>(0,s.jsx)("button",{onClick:()=>"number"==typeof e?q(e):null,disabled:"..."===e,className:`pagination-btn ${A===e?"active":""}`,children:e},t)),(0,s.jsx)("button",{onClick:()=>q(A+1),disabled:A===D,className:"pagination-btn",children:"Suivant →"})]})]})})]}),I.open&&I.pepiniere&&(0,s.jsx)(f,{open:I.open,pepiniere:I.pepiniere,onClose:()=>S({open:!1,pepiniere:null})}),v&&(0,s.jsx)(b.A,{pepiniere:v,onClose:()=>C(null)}),h&&(0,s.jsx)(E.A,{onClose:()=>g(!1),onSuccess:()=>{g(!1),"function"==typeof refetch&&refetch(),m("Export CSV termin\xe9 avec succ\xe8s","success")}})]})})}},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},58333:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\User\\\\Videos\\\\Nouveau dossier\\\\geomap\\\\geo-map-\\\\frontend\\\\src\\\\app\\\\pepinieres-globales\\\\page.js\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\User\\Videos\\Nouveau dossier\\geomap\\geo-map-\\frontend\\src\\app\\pepinieres-globales\\page.js","default")},62804:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var s=r(65239),n=r(48088),i=r(88170),a=r.n(i),l=r(30893),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(t,o);let d={children:["",{children:["pepinieres-globales",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,58333)),"C:\\Users\\User\\Videos\\Nouveau dossier\\geomap\\geo-map-\\frontend\\src\\app\\pepinieres-globales\\page.js"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,75535)),"C:\\Users\\User\\Videos\\Nouveau dossier\\geomap\\geo-map-\\frontend\\src\\app\\layout.js"],"not-found":[()=>Promise.resolve().then(r.bind(r,28069)),"C:\\Users\\User\\Videos\\Nouveau dossier\\geomap\\geo-map-\\frontend\\src\\app\\not-found.js"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["C:\\Users\\User\\Videos\\Nouveau dossier\\geomap\\geo-map-\\frontend\\src\\app\\pepinieres-globales\\page.js"],u={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/pepinieres-globales/page",pathname:"/pepinieres-globales",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78435:(e,t,r)=>{Promise.resolve().then(r.bind(r,27515))}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[176,804,829,995,852,349,899,975,887,489,589],()=>r(62804));module.exports=s})();