"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3225:(e,t,r)=>{r.d(t,{A:()=>a});var n=r(5155);function a(e){let{isOpen:t,onClose:r,onConfirm:a,title:o,message:s,confirmText:i="Confirmer",cancelText:l="Annuler",confirmButtonClass:d="bg-green-600 hover:bg-green-700",cancelButtonClass:c="bg-gray-300 hover:bg-gray-400",confirmLoading:u=!1,confirmDisabled:g=!1}=e;return t?(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:o}),(0,n.jsx)("p",{className:"text-gray-600 mb-6",children:s}),(0,n.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,n.jsx)("button",{onClick:r,className:"px-4 py-2 rounded font-semibold text-gray-700 ".concat(c),disabled:u,children:l}),(0,n.jsxs)("button",{onClick:a,className:"px-4 py-2 rounded font-semibold text-white flex items-center justify-center gap-2 ".concat(d),disabled:g,children:[u&&(0,n.jsx)("span",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2 inline-block"}),i]})]})]})}):null}r(2115)},5489:(e,t,r)=>{r.d(t,{z:()=>i});var n=r(2115),a=r(5695),o=r(6254),s=r(5384);function i(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],{user:t,isAuthenticated:r,isLoading:i}=(0,o.h)(),l=(0,a.useRouter)();return(0,n.useEffect)(()=>{if(!i){let t=s.Ep.getToken(),r=s.Ep.getUser(),n=window.location.pathname;if(e&&(!t||!r||s.Ep.isTokenExpired(t))){s.Ep.clearAuthData(),"/login"!==n&&"/register"!==n&&l.push("/login");return}}},[i,r,e,l]),{user:t,isAuthenticated:r,isLoading:i,isAuthorized:!e||r}}},6254:(e,t,r)=>{r.d(t,{AuthProvider:()=>l,h:()=>d});var n=r(5155),a=r(2115);r(9624);var o=r(5695),s=r(5384);let i=(0,a.createContext)();function l(e){let{children:t}=e,[r,l]=(0,a.useState)(null),[d,c]=(0,a.useState)(!1),[u,g]=(0,a.useState)(!0),[p,h]=(0,a.useState)(!1),x=(0,o.useRouter)();(0,a.useEffect)(()=>{let e=s.Ep.getToken(),t=s.Ep.getUser(),r=window.location.pathname;e&&t&&!s.Ep.isTokenExpired(e)?(l(t),c(!0)):(l(null),c(!1),s.Ep.clearAuthData(),["/","/login","/register","/pepinieres-globales","/parcelles-globales","/sieges-globaux"].includes(r)||x.push("/login")),g(!1)},[x]);let f=async()=>{h(!0),await new Promise(e=>setTimeout(e,700)),s.Ep.clearAuthData(),l(null),c(!1),h(!1);let e=window.location.pathname;"/"!==e&&"/login"!==e&&"/register"!==e&&x.push("/")};return(0,n.jsx)(i.Provider,{value:{user:r,isAuthenticated:d,isLoading:u,isLoggingOut:p,login:(e,t)=>{if("string"!=typeof t||!t.trim())return void console.error("Tentative de login avec un token invalide:",t);s.Ep.setAuthData(t,e),l(e),c(!0)},logout:f},children:t})}function d(){return(0,a.useContext)(i)}},7075:(e,t,r)=>{r.d(t,{bq:()=>u,eb:()=>p,gC:()=>g,l6:()=>d,yv:()=>c});var n=r(5155);r(2115);var a=r(8893),o=r(6474),s=r(5196),i=r(7863),l=r(5384);function d(e){let{...t}=e;return(0,n.jsx)(a.bL,{"data-slot":"select",...t})}function c(e){let{...t}=e;return(0,n.jsx)(a.WT,{"data-slot":"select-value",...t})}function u(e){let{className:t,size:r="default",children:s,...i}=e;return(0,n.jsxs)(a.l9,{"data-slot":"select-trigger","data-size":r,className:(0,l.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...i,children:[s,(0,n.jsx)(a.In,{asChild:!0,children:(0,n.jsx)(o.A,{className:"size-4 opacity-50"})})]})}function g(e){let{className:t,children:r,position:o="popper",...s}=e;return(0,n.jsx)(a.ZL,{children:(0,n.jsxs)(a.UC,{"data-slot":"select-content",className:(0,l.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===o&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:o,...s,children:[(0,n.jsx)(h,{}),(0,n.jsx)(a.LM,{className:(0,l.cn)("p-1","popper"===o&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:r}),(0,n.jsx)(x,{})]})})}function p(e){let{className:t,children:r,...o}=e;return(0,n.jsxs)(a.q7,{"data-slot":"select-item",className:(0,l.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...o,children:[(0,n.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,n.jsx)(a.VF,{children:(0,n.jsx)(s.A,{className:"size-4"})})}),(0,n.jsx)(a.p4,{children:r})]})}function h(e){let{className:t,...r}=e;return(0,n.jsx)(a.PP,{"data-slot":"select-scroll-up-button",className:(0,l.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,n.jsx)(i.A,{className:"size-4"})})}function x(e){let{className:t,...r}=e;return(0,n.jsx)(a.wn,{"data-slot":"select-scroll-down-button",className:(0,l.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,n.jsx)(o.A,{className:"size-4"})})}},7195:(e,t,r)=>{r.d(t,{p:()=>i});var n=r(4813),a=r(819),o=r(9736),s=r(5752);let i=(0,n.Nq)(function({position:e,...t},r){let n=new s.Marker(e,t);return(0,a.Q)(n,(0,o.W4)(r,{overlayContainer:n}))},function(e,t,r){t.position!==r.position&&e.setLatLng(t.position),null!=t.icon&&t.icon!==r.icon&&e.setIcon(t.icon),null!=t.zIndexOffset&&t.zIndexOffset!==r.zIndexOffset&&e.setZIndexOffset(t.zIndexOffset),null!=t.opacity&&t.opacity!==r.opacity&&e.setOpacity(t.opacity),null!=e.dragging&&t.draggable!==r.draggable&&(!0===t.draggable?e.dragging.enable():e.dragging.disable())})},8255:(e,t,r)=>{r.d(t,{Po:()=>i,gY:()=>s,ko:()=>o});var n=r(9736),a=r(2115);function o(){return(0,n.U$)().map}function s(e,t){let r=o();return(0,a.useEffect)(function(){return r.on(e,t),function(){r.off(e,t)}},[r,e,t]),r}function i(e){let t=o();return(0,a.useEffect)(function(){return t.on(e),function(){t.off(e)}},[t,e]),t}},8565:(e,t,r)=>{r.d(t,{A:()=>x});var n=r(5155),a=r(2115),o=r(8255),s=r(3704),i=r(8790),l=r(7195);r(8413);var d=r(5752),c=r.n(d);let u={position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},g={background:"white",borderRadius:"8px",padding:"24px",width:"600px",minWidth:"350px",height:"500px",minHeight:"400px",maxWidth:"90vw",maxHeight:"90vh",display:"flex",flexDirection:"column"},p=new(c()).Icon({iconUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});function h(e){let{position:t,setPosition:r}=e;return(0,o.Po)({click(e){r([e.latlng.lat,e.latlng.lng])}}),null}let x=e=>{let{open:t,onClose:r,onSave:o,initialPosition:d}=e,[c,x]=(0,a.useState)(d||null),[f,m]=(0,a.useState)("standard");return t?(0,n.jsx)("div",{style:{...u,zIndex:1e3},children:(0,n.jsxs)("div",{style:{...g,width:"100vw",minWidth:"100vw",height:"100vh",minHeight:"100vh",maxWidth:"100vw",maxHeight:"100vh",padding:0,boxSizing:"border-box",display:"flex",flexDirection:"column"},children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-2",style:{padding:"16px 24px 0 24px"},children:[(0,n.jsx)("h2",{className:"text-lg font-bold",children:"S\xe9lectionner la position du si\xe8ge"}),(0,n.jsx)("div",{className:"flex items-center space-x-2",children:(0,n.jsxs)("select",{value:f,onChange:e=>m(e.target.value),className:"px-2 py-1 border border-gray-300 rounded-md text-gray-700 bg-white hover:bg-gray-100",style:{fontSize:"0.95em"},children:[(0,n.jsx)("option",{value:"standard",children:"Standard"}),(0,n.jsx)("option",{value:"satellite",children:"Satellite + labels"})]})})]}),(0,n.jsx)("div",{style:{flex:1,minHeight:0},children:(0,n.jsxs)(s.W,{center:c||[-19,47],zoom:c?12:6,style:{height:"100%",width:"100%"},children:["standard"===f&&(0,n.jsx)(i.e,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:"\xa9 OpenStreetMap contributors"}),"satellite"===f&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.e,{url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles \xa9 Esri â€” Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"}),(0,n.jsx)(i.e,{url:"https://server.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",attribution:"Labels \xa9 Esri"})]}),(0,n.jsx)(h,{position:c,setPosition:x}),c&&(0,n.jsx)(l.p,{position:c,icon:p})]})}),(0,n.jsxs)("div",{className:"flex justify-end mt-4 space-x-2",style:{background:"white",padding:"0 24px 24px 24px",borderBottomLeftRadius:8,borderBottomRightRadius:8,boxShadow:"0 -2px 8px rgba(0,0,0,0.04)"},children:[(0,n.jsx)("button",{onClick:r,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Annuler"}),(0,n.jsx)("button",{onClick:()=>{c&&(o({type:"Point",coordinates:[c[1],c[0]]}),r())},disabled:!c,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50",children:"Valider"})]})]})}):null}},9624:(e,t,r)=>{r.d(t,{A:()=>p});var n=r(8592),a=r(524),o=r(2641),s=r(4076),i=r(1957),l=r(883),d=r(9159);let c=(0,l.A)({uri:"".concat("http://91.204.209.201:8000","/graphql/")}),u=(0,s.o)((e,t)=>{let{headers:r}=t,n=localStorage.getItem("token");if(n)try{let e=(0,d.s)(n),t=Date.now()/1e3;if(e.exp<t)return localStorage.removeItem("token"),localStorage.removeItem("user"),{headers:{...r,authorization:""}}}catch(e){return console.error("Apollo Client - Erreur lors du d\xe9codage du token:",e),localStorage.removeItem("token"),localStorage.removeItem("user"),{headers:{...r,authorization:""}}}return{headers:{...r,authorization:n?"JWT ".concat(n):""}}}),g=(0,i.S)(e=>{let{graphQLErrors:t,networkError:r,operation:n,forward:a}=e;t&&t.forEach(e=>{let{message:t,locations:r,path:n,extensions:a}=e;console.error("[GraphQL error]: Message: ".concat(t,", Location: ").concat(r,", Path: ").concat(n)),((null==a?void 0:a.code)==="UNAUTHENTICATED"||t.includes("authentication")||t.includes("decoding signature")||t.includes("token")||t.includes("expired"))&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/errors/401"),((null==a?void 0:a.code)==="BAD_REQUEST"||t.includes("bad request")||t.includes("invalid"))&&(window.location.href="/errors/400"),((null==a?void 0:a.code)==="NOT_FOUND"||t.includes("not found"))&&(window.location.href="/errors/404"),((null==a?void 0:a.code)==="INTERNAL_SERVER_ERROR"||t.includes("server error"))&&(window.location.href="/errors/500")}),r&&(console.error("[Network error]: ".concat(r)),400===r.statusCode?window.location.href="/errors/400":401===r.statusCode?(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/errors/401"):404===r.statusCode?window.location.href="/errors/404":500===r.statusCode&&(window.location.href="/errors/500"))}),p=new n.R({link:(0,a.H)([g,u,c]),cache:new o.D,defaultOptions:{watchQuery:{errorPolicy:"all"},query:{errorPolicy:"all"}}})}}]);