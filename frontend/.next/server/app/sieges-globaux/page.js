(()=>{var e={};e.id=234,e.ids=[234],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11180:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\Fitahiana\\\\Documents\\\\GitHub\\\\Agri-Geo\\\\frontend\\\\src\\\\app\\\\sieges-globaux\\\\page.js\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\Fitahiana\\Documents\\GitHub\\Agri-Geo\\frontend\\src\\app\\sieges-globaux\\page.js","default")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},20911:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>I});var r=t(60687),i=t(43210),a=t.n(i),l=t(8829),n=t(48443),o=t(92049),d=t(93661),c=t(54220),u=t(76717),x=t(92120),h=t(65222),m=t(83361),g=t(2710);let p={position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},b={background:"white",borderRadius:"8px",padding:"24px",width:"600px",minWidth:"350px",height:"500px",minHeight:"400px",maxWidth:"95vw",maxHeight:"95vh",display:"flex",flexDirection:"column"};function j({open:e,onClose:s,siege:t}){let[i,l]=a().useState("street");return e&&t?(0,r.jsx)("div",{style:p,children:(0,r.jsxs)("div",{style:b,children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("h2",{className:"text-lg font-bold",children:"Voir sur la carte"}),(0,r.jsx)("button",{onClick:s,className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300",children:"Fermer"})]}),(0,r.jsxs)("div",{className:"mb-2 flex gap-2 items-center",children:[(0,r.jsx)("label",{htmlFor:"map-style",className:"font-medium",children:"Style de carte :"}),(0,r.jsxs)("select",{id:"map-style",value:i,onChange:e=>l(e.target.value),className:"px-2 py-1 border rounded",children:[(0,r.jsx)("option",{value:"street",children:"Carte routi\xe8re"}),(0,r.jsx)("option",{value:"satellite",children:"Satellite"}),(0,r.jsx)("option",{value:"hybrid",children:"Hybride"})]})]}),(0,r.jsx)("div",{style:{flex:1,minHeight:0},children:(0,r.jsx)(g.A,{sieges:[t],style:{height:"100%",width:"100%"},center:[parseFloat(t.latitude)||-18.7669,parseFloat(t.longitude)||46.8691],mapStyle:i})})]})}):null}let f=({row:e})=>{let[s,t]=(0,i.useState)(!1),[a,l]=(0,i.useState)(!1);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(x.rI,{children:[(0,r.jsx)(x.ty,{asChild:!0,children:(0,r.jsxs)(u.$,{variant:"ghost",className:"h-8 w-8 p-0",children:[(0,r.jsx)("span",{className:"sr-only",children:"Ouvrir le menu"}),(0,r.jsx)(d.A,{className:"h-4 w-4"})]})}),(0,r.jsxs)(x.SQ,{align:"end",children:[(0,r.jsx)(x.lp,{children:"Actions"}),(0,r.jsx)(x._2,{onClick:()=>t(!0),children:"Voir d\xe9tails"}),(0,r.jsx)(x._2,{onClick:()=>l(!0),children:"Voir sur la carte"}),(0,r.jsx)(x.mB,{})]})]}),s&&(0,r.jsx)(m.A,{siege:e.original,onClose:()=>t(!1)}),a&&(0,r.jsx)(j,{open:a,siege:e.original,onClose:()=>l(!1)})]})},v={social:"Si\xe8ge social",regional:"Si\xe8ge r\xe9gional",technique:"Si\xe8ge technique",provisoire:"Si\xe8ge provisoire"},N=(e,s)=>[{accessorKey:"Nom du local",header:({column:e})=>(0,r.jsx)("div",{className:"text-center",children:(0,r.jsxs)(u.$,{variant:"ghost",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),children:["Nom du local ",(0,r.jsx)(c.A,{className:"ml-2 h-4 w-4"})]})}),cell:({row:e})=>(0,r.jsx)("div",{className:"text-center",children:e.original.nom})},{id:"Institutions",header:"Institutions",cell:({row:e})=>{let s=e.original.user;return(0,r.jsxs)("div",{className:"flex items-center",children:[s?.logo&&(0,r.jsx)("img",{src:(0,h.D1)(s.logo),alt:"Logo",className:"w-6 h-6 rounded-full mr-2"}),(0,r.jsx)("div",{children:(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:s?.nomInstitution})})]})}},{accessorKey:"Personne R\xe9f\xe9rente",header:"Personne r\xe9f\xe9rente",cell:({row:e})=>{let s=e.original;return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-medium",children:s.nomPointContact||"-"}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:s.poste||"-"}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:s.telephone||"-"}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:s.email||"-"})]})}},{accessorKey:"Adresse",header:()=>(0,r.jsx)("div",{className:"text-center",children:"Adresse"}),cell:({row:e})=>(0,r.jsx)("div",{className:"text-center",children:e.original.adresse})},{accessorKey:"Projet rattach\xe9",header:()=>(0,r.jsx)("div",{className:"text-center",children:"Projet rattach\xe9"}),cell:({row:e})=>(0,r.jsx)("div",{className:"text-center",children:e.original.nomProjet||"-"})},{accessorKey:"Cat\xe9gorie",header:()=>(0,r.jsx)("div",{className:"text-center",children:"Cat\xe9gorie"}),cell:({row:e})=>{let s=e.original.categorie;return(0,r.jsx)("div",{className:"text-center",children:v[(s||"").toLowerCase()]||s||"-"})}},{id:"actions",header:"Actions",cell:({row:t})=>(0,r.jsx)(f,{row:t,onViewDetails:e,onViewMap:s}),enableSorting:!1,enableHiding:!1}];var y=t(32168),C=t(21426),w=t(78272);let A=[{value:"social",label:"Si\xe8ge social"},{value:"regional",label:"Si\xe8ge r\xe9gional"},{value:"technique",label:"Si\xe8ge technique"},{value:"provisoire",label:"Si\xe8ge provisoire"}];function S({selectedCategories:e,onFilterChange:s}){let[t,a]=(0,i.useState)(!1),l=(0,i.useRef)(null),n=t=>{let r;s(e.includes(t)?e.filter(e=>e!==t):[...e,t])};return(0,r.jsxs)("div",{className:"relative",ref:l,children:[(0,r.jsx)("button",{type:"button",className:"w-full px-3 py-2 text-left bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",onClick:()=>a(!t),children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"block truncate text-gray-700",children:(()=>{if(0===e.length||e.length===A.length)return"Toutes les cat\xe9gories";if(1===e.length){let s=A.find(s=>s.value===e[0]);return s?s.label:e[0]}return`${e.length} cat\xe9gories s\xe9lectionn\xe9es`})()}),(0,r.jsx)(w.A,{className:`h-4 w-4 text-gray-400 transition-transform ${t?"rotate-180":""}`})]})}),t&&(0,r.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg",children:(0,r.jsxs)("div",{className:"py-1 max-h-60 overflow-auto",children:[(0,r.jsx)("div",{className:"px-3 py-2 hover:bg-gray-100 cursor-pointer border-b border-gray-200",onClick:()=>{e.length===A.length?s([]):s(A.map(e=>e.value))},children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded",checked:e.length===A.length,onChange:()=>{},onClick:e=>e.stopPropagation()}),(0,r.jsx)("label",{className:"ml-2 text-sm text-gray-900 font-medium",children:"Toutes les cat\xe9gories"})]})}),A.map(s=>(0,r.jsx)("div",{className:"px-3 py-2 hover:bg-gray-100 cursor-pointer",onClick:()=>n(s.value),children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded",checked:e.includes(s.value),onChange:()=>{},onClick:e=>e.stopPropagation()}),(0,r.jsx)("label",{className:"ml-2 text-sm text-gray-900",children:s.label})]})},s.value))]})})]})}var P=t(89252);function I(){let[e,s]=(0,i.useState)([]),[t,a]=(0,i.useState)([]),[d,c]=(0,i.useState)([]),[x,h]=(0,i.useState)(""),{showError:m}=(0,o.d)(),[g]=(0,i.useState)({open:!1,siege:null}),[p,b]=(0,i.useState)({open:!1,siege:null}),[f,v]=(0,i.useState)(1),[w,A]=(0,i.useState)(10),{data:I,loading:E,error:_}=(0,l.IT)(n._Q),{data:k,loading:T,error:R}=(0,l.IT)(n.em),D=d.length,G=Math.ceil(D/w),F=(f-1)*w,O=F+w,H=d.slice(F,O);if(_&&(m("Erreur lors du chargement des si\xe8ges"),console.error("Sieges error:",_)),R&&(m("Erreur lors du chargement des utilisateurs"),console.error("Users error:",R)),E||T)return(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-indigo-600"})});let M=e=>{v(e)};return(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold midnight-blue-text mb-2",children:"Liste des locaux"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Consultez tous les locaux de tous les institutions de la plateforme."})]}),(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-6",children:(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[(0,r.jsxs)("div",{className:"flex-1 mb-4 lg:mb-0",children:[(0,r.jsx)("h3",{className:"text-lg font-medium midnight-blue-text mb-3",children:"Filtrer par membre"}),(0,r.jsx)(C.A,{users:k?.allUsers||[],selectedMembers:e,onFilterChange:e=>{s(e)}})]}),(0,r.jsxs)("div",{className:"flex-1 mb-4 lg:mb-0",children:[(0,r.jsx)("h3",{className:"text-lg font-medium midnight-blue-text mb-3",children:"Filtrer par cat\xe9gorie"}),(0,r.jsx)(S,{selectedCategories:t,onFilterChange:e=>{a(e)}})]}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"text-lg font-medium midnight-blue-text mb-3",children:"Recherche globale"}),(0,r.jsx)("input",{type:"text",value:x,onChange:e=>{h(e.target.value)},placeholder:"Rechercher dans toutes les colonnes...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})]})}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border",children:[(0,r.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("h3",{className:"text-lg font-medium midnight-blue-text",children:["Locaux (",D,")"]}),(e.length>0||t.length>0)&&(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:[e.length>0&&`Filtr\xe9 par ${e.length} membre(s)`,e.length>0&&t.length>0&&" - ",t.length>0&&`${t.length} cat\xe9gorie(s)`]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("label",{htmlFor:"itemsPerPage",className:"text-sm text-gray-600",children:"Afficher:"}),(0,r.jsxs)("select",{id:"itemsPerPage",value:w,onChange:e=>{A(parseInt(e.target.value)),v(1)},className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[(0,r.jsx)("option",{value:10,children:"10"}),(0,r.jsx)("option",{value:25,children:"25"}),(0,r.jsx)("option",{value:50,children:"50"}),(0,r.jsx)("option",{value:100,children:"100"})]}),(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"lignes"})]}),(0,r.jsx)(u.$,{className:"midnight-blue-btn px-4 py-2 rounded-md font-bold text-sm",onClick:()=>{let e=new Date().toISOString().slice(0,10),s=`locaux_export_${e}.csv`,t=d.map(e=>({NOM:e.nom||"",INSTITUTION:e.user?.nomInstitution||"",ABREVIATION:e.user?.abreviation||"",PROJET_RATTACHE:e.nomProjet||"",CATEGORIE:e.categorie||"",NOM_POINT_CONTACT:e.nomPointContact||"",POSTE:e.poste||"",TELEPHONE:e.telephone||"",EMAIL:e.email||"",HORAIRE_MATIN:e.horaireMatin||"",HORAIRE_APRES_MIDI:e.horaireApresMidi||"",ADRESSE:e.adresse||"",LATITUDE:e.latitude||"",LONGITUDE:e.longitude||"",DESCRIPTION:e.description||"",DATE_CREATION:e.createdAt?new Date(e.createdAt).toLocaleDateString("fr-FR"):"",DERNIERE_MODIFICATION:e.updatedAt?new Date(e.updatedAt).toLocaleDateString("fr-FR"):""}));(0,P.G)(t,s)},disabled:0===d.length,children:"Exporter CSV"})]})]})}),(0,r.jsx)("div",{className:"p-6",children:(0,r.jsx)(y.b,{columns:N(e=>{g({open:!0,siege:e})},e=>{b({open:!0,siege:e})}),data:H})}),G>1&&(0,r.jsx)("div",{className:"px-6 py-4 border-t border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["Affichage de ",F+1," \xe0 ",Math.min(O,D)," sur ",D," r\xe9sultats"]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("button",{onClick:()=>M(f-1),disabled:1===f,className:"pagination-btn",children:"← Pr\xe9c\xe9dent"}),(()=>{let e=[];if(G<=5)for(let s=1;s<=G;s++)e.push(s);else if(f<=3){for(let s=1;s<=4;s++)e.push(s);e.push("..."),e.push(G)}else if(f>=G-2){e.push(1),e.push("...");for(let s=G-3;s<=G;s++)e.push(s)}else{e.push(1),e.push("...");for(let s=f-1;s<=f+1;s++)e.push(s);e.push("..."),e.push(G)}return e})().map((e,s)=>(0,r.jsx)("button",{onClick:()=>"number"==typeof e?M(e):null,disabled:"..."===e,className:`pagination-btn ${f===e?"active":""}`,children:e},s)),(0,r.jsx)("button",{onClick:()=>M(f+1),disabled:f===G,className:"pagination-btn",children:"Suivant →"})]})]})})]}),p.open&&p.siege&&(0,r.jsx)(j,{open:p.open,siege:p.siege,onClose:()=>{b({open:!1,siege:null})}})]})})}},24566:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>l.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d});var r=t(65239),i=t(48088),a=t(88170),l=t.n(a),n=t(30893),o={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);t.d(s,o);let d={children:["",{children:["sieges-globaux",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,11180)),"C:\\Users\\Fitahiana\\Documents\\GitHub\\Agri-Geo\\frontend\\src\\app\\sieges-globaux\\page.js"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,75535)),"C:\\Users\\Fitahiana\\Documents\\GitHub\\Agri-Geo\\frontend\\src\\app\\layout.js"],"not-found":[()=>Promise.resolve().then(t.bind(t,28069)),"C:\\Users\\Fitahiana\\Documents\\GitHub\\Agri-Geo\\frontend\\src\\app\\not-found.js"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["C:\\Users\\Fitahiana\\Documents\\GitHub\\Agri-Geo\\frontend\\src\\app\\sieges-globaux\\page.js"],u={require:t,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/sieges-globaux/page",pathname:"/sieges-globaux",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},26081:(e,s,t)=>{Promise.resolve().then(t.bind(t,20911))},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79551:e=>{"use strict";e.exports=require("url")},89633:(e,s,t)=>{Promise.resolve().then(t.bind(t,11180))}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[447,575,804,829,995,852,349,498,975,361,489,710],()=>t(24566));module.exports=r})();